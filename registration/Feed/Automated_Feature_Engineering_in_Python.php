<!DOCTYPE html>
                <html>
                <head>
                    <title>Automated Feature Engineering in Python</title>
                <?php include_once 'Elemental/header.php'; ?><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><br><br><h5> This article is reformatted from originally published at <a href="https://towardsdatascience.com/automated-feature-engineering-in-python-99baf11cc219"><strong>TDS(Towards Data Science)</strong></a></h5></br><h5> <a href="https://williamkoehrsen.medium.com/?source=post_page-----99baf11cc219--------------------------------">Author : Will Koehrsen</a> </h5></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lg3OxWVYDsJFN-snBY7M5w.jpeg 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*lg3OxWVYDsJFN-snBY7M5w.jpeg"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content4 cid-tt5SM2WLsM" id="content4-2" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="title col-md-12 col-lg-9">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                            <strong>Automated Feature Engineering in Python</h3></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5 text-muted">How to automatically create machine learning features</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Machine learning is increasingly moving from hand-designed models to automatically optimized pipelines using tools such as <a href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html" target="_self">H20</a>, <a href="https://epistasislab.github.io/tpot/" target="_self">TPOT</a>, and <a href="https://automl.github.io/auto-sklearn/stable/" target="_self">auto-sklearn</a>. These libraries, along with methods such as <a href="http://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf" target="_self">random search</a>, aim to simplify the model selection and tuning parts of machine learning by finding the best model for a dataset with little to no manual intervention. However, feature engineering, an <a href="https://www.featurelabs.com/blog/secret-to-data-science-success/" target="_self">arguably more valuable aspect</a> of the machine learning pipeline, remains almost entirely a human labor.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><a href="https://en.wikipedia.org/wiki/Feature_engineering" target="_self">Feature engineering</a>, also known as feature creation, is the process of constructing new features from existing data to train a machine learning model. This step can be more important than the actual model used because a machine learning algorithm only learns from the data we give it, and creating features that are relevant to a task is absolutely crucial (see the excellent paper <a href="https://homes.cs.washington.edu/~pedrod/papers/cacm12.pdf" target="_self">“A Few Useful Things to Know about Machine Learning”</a>).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Typically, feature engineering is a drawn-out manual process, relying on domain knowledge, intuition, and data manipulation. This process can be extremely tedious and the final features will be limited both by human subjectivity and time. <mark>Automated feature engineering aims to help the data scientist by automatically creating many candidate features out of a dataset from which the best can be selected and used for training.</mark></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In this article, we will walk through an example of using automated feature engineering with the <a href="https://docs.featuretools.com/#" target="_self">featuretools Python library</a>. We will use an example dataset to show the basics (stay tuned for future posts using real-world data). The complete code for this article is <a href="https://github.com/WillKoehrsen/automated-feature-engineering/blob/master/walk_through/Automated_Feature_Engineering.ipynb" target="_self">available on GitHub</a>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Feature Engineering Basics</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><a href="https://www.datacamp.com/community/tutorials/feature-engineering-kaggle" target="_self">Feature engineering</a> means building additional features out of existing data which is often spread across multiple related tables. Feature engineering requires extracting the relevant information from the data and getting it into a single table which can then be used to train a machine learning model.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The process of constructing features is very time-consuming because each new feature usually requires several steps to build, especially when using information from more than one table. We can group the operations of feature creation into two categories: <strong>transformations</strong> and <strong>aggregations</strong>. Let’s look at a few examples to see these concepts in action.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">A <strong>transformation</strong> acts on a single table (thinking in terms of Python, a table is just a Pandas <code>DataFrame</code> ) by creating new features out of one or more of the existing columns. As an example, if we have the table of clients below</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:39%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 304px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 1100w, https://miro.medium.com/v2/resize:fit:608/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 608w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 304px" srcset="https://miro.medium.com/v2/resize:fit:640/1*FHR7tlD4FuGKt8n5UHUpqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FHR7tlD4FuGKt8n5UHUpqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FHR7tlD4FuGKt8n5UHUpqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FHR7tlD4FuGKt8n5UHUpqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FHR7tlD4FuGKt8n5UHUpqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FHR7tlD4FuGKt8n5UHUpqw.png 1100w, https://miro.medium.com/v2/resize:fit:608/1*FHR7tlD4FuGKt8n5UHUpqw.png 608w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/304/1*FHR7tlD4FuGKt8n5UHUpqw.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">we can create features by finding the month of the <code>joined</code> column or taking the natural log of the <code>income</code> column. These are both transformations because they use information from only one table.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:64%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 478px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 1100w, https://miro.medium.com/v2/resize:fit:956/format:webp/1*QQGYN1PD06rNT-bJphNcBA.png 956w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 478px" srcset="https://miro.medium.com/v2/resize:fit:640/1*QQGYN1PD06rNT-bJphNcBA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QQGYN1PD06rNT-bJphNcBA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QQGYN1PD06rNT-bJphNcBA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QQGYN1PD06rNT-bJphNcBA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QQGYN1PD06rNT-bJphNcBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QQGYN1PD06rNT-bJphNcBA.png 1100w, https://miro.medium.com/v2/resize:fit:956/1*QQGYN1PD06rNT-bJphNcBA.png 956w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/478/1*QQGYN1PD06rNT-bJphNcBA.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">On the other hand, <strong>aggregations</strong> are performed across tables, and use a one-to-many relationship to group observations and then calculate statistics. For example, if we have another table with information on the loans of clients, where each client may have multiple loans, we can calculate statistics such as the average, maximum, and minimum of loans for each client.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This process involves grouping the loans table by the client, calculating the aggregations, and then merging the resulting data into the client data. Here’s how we would do that in Python using the <a href="https://pandas.pydata.org/pandas-docs/stable/index.html" target="_self">language of Pandas</a>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>import pandas as pd

# Group loans by client id and calculate mean, max, min of loans
stats = loans.groupby('client_id')['loan_amount'].agg(['mean', 'max', 'min'])
stats.columns = ['mean_loan_amount', 'max_loan_amount', 'min_loan_amount']

# Merge with the clients dataframe
stats = clients.merge(stats, left_on = 'client_id', right_index=True, how = 'left')

stats.head(10)</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHHOuEft93KDenbRpaFcnA.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*jHHOuEft93KDenbRpaFcnA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jHHOuEft93KDenbRpaFcnA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jHHOuEft93KDenbRpaFcnA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jHHOuEft93KDenbRpaFcnA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jHHOuEft93KDenbRpaFcnA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jHHOuEft93KDenbRpaFcnA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jHHOuEft93KDenbRpaFcnA.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*jHHOuEft93KDenbRpaFcnA.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">These operations are not difficult by themselves, but if we have hundreds of variables spread across dozens of tables, this process is not feasible to do by hand. Ideally, we want a solution that can automatically perform transformations and aggregations across multiple tables and combine the resulting data into a single table. Although Pandas is a great resource, there’s only so much data manipulation we want to do by hand! (For more on manual feature engineering check out the excellent <a href="https://jakevdp.github.io/PythonDataScienceHandbook/05.04-feature-engineering.html" target="_self">Python Data Science Handbook</a>).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Featuretools</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Fortunately, featuretools is exactly the solution we are looking for. This open-source Python library will automatically create many features from a set of related tables. Featuretools is based on a method known as “<a href="http://featurelabs1.wpengine.com/wp-content/uploads/2017/12/DSAA_DSM_2015-1.pdf" target="_self">Deep Feature Synthesis</a>”, which sounds a lot more imposing than it actually is (the name comes from stacking multiple features not because it uses deep learning!).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Deep feature synthesis stacks multiple transformation and aggregation operations (which are called<a href="https://docs.featuretools.com/automated_feature_engineering/primitives.html" target="_self"> feature primitives</a> in the vocab of featuretools) to create features from data spread across many tables. Like most ideas in machine learning, it’s a complex method built on a foundation of simple concepts. By learning one building block at a time, we can form a good understanding of this powerful method.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">First, let’s take a look at our example data. We already saw some of the dataset above, and the complete collection of tables is as follows:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;"><code>clients</code> : basic information about clients at a credit union. Each client has only one row in this dataframe</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:39%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 304px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 1100w, https://miro.medium.com/v2/resize:fit:608/format:webp/1*FHR7tlD4FuGKt8n5UHUpqw.png 608w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 304px" srcset="https://miro.medium.com/v2/resize:fit:640/1*FHR7tlD4FuGKt8n5UHUpqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FHR7tlD4FuGKt8n5UHUpqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FHR7tlD4FuGKt8n5UHUpqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FHR7tlD4FuGKt8n5UHUpqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FHR7tlD4FuGKt8n5UHUpqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FHR7tlD4FuGKt8n5UHUpqw.png 1100w, https://miro.medium.com/v2/resize:fit:608/1*FHR7tlD4FuGKt8n5UHUpqw.png 608w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/304/1*FHR7tlD4FuGKt8n5UHUpqw.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;"><code>loans</code>: loans made to the clients. Each loan has only own row in this dataframe but clients may have multiple loans.</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:75%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 555px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 1100w, https://miro.medium.com/v2/resize:fit:1110/format:webp/1*95c7QchQVM-9xUUA4ZB4XQ.png 1110w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 555px" srcset="https://miro.medium.com/v2/resize:fit:640/1*95c7QchQVM-9xUUA4ZB4XQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*95c7QchQVM-9xUUA4ZB4XQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*95c7QchQVM-9xUUA4ZB4XQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*95c7QchQVM-9xUUA4ZB4XQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*95c7QchQVM-9xUUA4ZB4XQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*95c7QchQVM-9xUUA4ZB4XQ.png 1100w, https://miro.medium.com/v2/resize:fit:1110/1*95c7QchQVM-9xUUA4ZB4XQ.png 1110w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/555/1*95c7QchQVM-9xUUA4ZB4XQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;"><code>payments</code>: payments made on the loans. Each payment has only one row but each loan will have multiple payments.</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:46%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 350px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 1100w, https://miro.medium.com/v2/resize:fit:700/format:webp/1*RbgNzspaiwq74aWU6W5LWQ.png 700w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 350px" srcset="https://miro.medium.com/v2/resize:fit:640/1*RbgNzspaiwq74aWU6W5LWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RbgNzspaiwq74aWU6W5LWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RbgNzspaiwq74aWU6W5LWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RbgNzspaiwq74aWU6W5LWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RbgNzspaiwq74aWU6W5LWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RbgNzspaiwq74aWU6W5LWQ.png 1100w, https://miro.medium.com/v2/resize:fit:700/1*RbgNzspaiwq74aWU6W5LWQ.png 700w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/350/1*RbgNzspaiwq74aWU6W5LWQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">If we have a machine learning task, such as predicting whether a client will repay a future loan, we will want to combine all the information about clients into a single table. The tables are related (through the <code>client_id</code> and the <code>loan_id</code> variables) and we could use a series of transformations and aggregations to do this process by hand. However, we will shortly see that we can instead use featuretools to automate the process.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Entities and EntitySets</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The first two concepts of featuretools are <strong>entities</strong> and <strong>entitysets</strong>. An entity is simply a table (or a <code>DataFrame</code> if you think in Pandas). An <a href="https://docs.featuretools.com/loading_data/using_entitysets.html" target="_self">EntitySet</a> is a collection of tables and the relationships between them. Think of an entityset as just another Python data structure, with its own methods and attributes.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We can create an empty entityset in featuretools using the following:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>import featuretools as ft</span><span># Create new entityset<br/>es = ft.EntitySet(id = 'clients')</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Now we have to add entities. Each entity must have an index, which is a column with all unique elements. That is, each value in the index must appear in the table only once. The index in the <code>clients</code> dataframe is the <code>client_id</code>because each client has only one row in this dataframe. We add an entity with an existing index to an entityset using the following syntax:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Create an entity from the client dataframe
# This dataframe already has an index and a time index
es = es.entity_from_dataframe(entity_id = 'clients', dataframe = clients, 
                              index = 'client_id', time_index = 'joined')</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The <code>loans</code> dataframe also has a unique index, <code>loan_id </code>and the syntax to add this to the entityset is the same as for <code>clients</code>. However, for the <code>payments</code> dataframe, there is no unique index. When we add this entity to the entityset, we need to pass in the parameter <code>make_index = True</code> and specify the name of the index. Also, although featuretools will automatically infer the data type of each column in an entity, we can override this by passing in a dictionary of column types to the parameter <code>variable_types</code> .</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Create an entity from the payments dataframe
# This does not yet have a unique index
es = es.entity_from_dataframe(entity_id = 'payments', 
                              dataframe = payments,
                              variable_types = {'missed': ft.variable_types.Categorical},
                              make_index = True,
                              index = 'payment_id',
                              time_index = 'payment_date')</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For this dataframe, even though <code>missed</code> is an integer, this is not a <a href="https://socratic.org/questions/what-is-a-numerical-variable-and-what-is-a-categorical-variable" target="_self">numeric variable</a> since it can only take on 2 discrete values, so we tell featuretools to treat is as a categorical variable. After adding the dataframes to the entityset, we inspect any of them:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:66%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 496px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 1100w, https://miro.medium.com/v2/resize:fit:992/format:webp/1*DZ44KuggN_4jWKwuhrpCaw.png 992w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 496px" srcset="https://miro.medium.com/v2/resize:fit:640/1*DZ44KuggN_4jWKwuhrpCaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DZ44KuggN_4jWKwuhrpCaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DZ44KuggN_4jWKwuhrpCaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DZ44KuggN_4jWKwuhrpCaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DZ44KuggN_4jWKwuhrpCaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DZ44KuggN_4jWKwuhrpCaw.png 1100w, https://miro.medium.com/v2/resize:fit:992/1*DZ44KuggN_4jWKwuhrpCaw.png 992w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/496/1*DZ44KuggN_4jWKwuhrpCaw.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The column types have been correctly inferred with the modification we specified. Next, we need to specify how the tables in the entityset are related.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Table Relationships</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The best way to think of a<strong> relationship</strong> between two tables is the <a href="https://stackoverflow.com/questions/7880921/what-is-a-parent-table-and-a-child-table-in-database" target="_self">analogy of parent to child</a>. This is a one-to-many relationship: each parent can have multiple children. In the realm of tables, a parent table has one row for every parent, but the child table may have multiple rows corresponding to multiple children of the same parent.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For example, in our dataset, the <code>clients</code> dataframe is a parent of the <code>loans</code> dataframe. Each client has only one row in <code>clients</code> but may have multiple rows in <code>loans</code>. Likewise, <code>loans</code> is the parent of <code>payments</code> because each loan will have multiple payments. The parents are linked to their children by a shared variable. When we perform aggregations, we group the child table by the parent variable and calculate statistics across the children of each parent.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">To <a href="https://docs.featuretools.com/loading_data/using_entitysets.html#adding-a-relationship" target="_self">formalize a relationship in featuretools</a>, we only need to specify the variable that links two tables together. The <code>clients</code> and the <code>loans</code> table are linked via the <code>client_id</code> variable and <code>loans</code> and <code>payments</code> are linked with the <code>loan_id</code>. The syntax for creating a relationship and adding it to the entityset are shown below:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Relationship between clients and previous loans
r_client_previous = ft.Relationship(es['clients']['client_id'],
                                    es['loans']['client_id'])

# Add the relationship to the entity set
es = es.add_relationship(r_client_previous)

# Relationship between previous loans and previous payments
r_payments = ft.Relationship(es['loans']['loan_id'],
                                      es['payments']['loan_id'])

# Add the relationship to the entity set
es = es.add_relationship(r_payments)

es</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:46%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 355px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 1100w, https://miro.medium.com/v2/resize:fit:710/format:webp/1*W_jS8Z4Ym5zAFTdjHki1ig.png 710w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 355px" srcset="https://miro.medium.com/v2/resize:fit:640/1*W_jS8Z4Ym5zAFTdjHki1ig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*W_jS8Z4Ym5zAFTdjHki1ig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*W_jS8Z4Ym5zAFTdjHki1ig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*W_jS8Z4Ym5zAFTdjHki1ig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*W_jS8Z4Ym5zAFTdjHki1ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*W_jS8Z4Ym5zAFTdjHki1ig.png 1100w, https://miro.medium.com/v2/resize:fit:710/1*W_jS8Z4Ym5zAFTdjHki1ig.png 710w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/355/1*W_jS8Z4Ym5zAFTdjHki1ig.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The entityset now contains the three entities (tables) and the relationships that link these entities together. After adding entities and formalizing relationships, our entityset is complete and we are ready to make features.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Feature Primitives</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Before we can quite get to deep feature synthesis, we need to understand <a href="https://docs.featuretools.com/automated_feature_engineering/primitives.html" target="_self">feature primitives</a>. We already know what these are, but we have just been calling them by different names! These are simply the basic operations that we use to form new features:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">Aggregations: operations completed across a parent-to-child (one-to-many) relationship that group by the parent and calculate stats for the children. An example is grouping the <code>loan</code> table by the <code>client_id</code> and finding the maximum loan amount for each client.</li><li class="ff3" style="font-size:22px;">Transformations: operations done on a single table to one or more columns. An example is taking the difference between two columns in one table or taking the absolute value of a column.</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">New features are created in featuretools using these primitives either by themselves or stacking multiple primitives. Below is a list of some of the feature primitives in featuretools (we can also <a href="https://docs.featuretools.com/guides/advanced_custom_primitives.html" target="_self">define custom primitives</a>):</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:90%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 658px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1316/format:webp/1*_p-HwN54IjLvmSSlkkazUQ.png 1316w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 658px" srcset="https://miro.medium.com/v2/resize:fit:640/1*_p-HwN54IjLvmSSlkkazUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_p-HwN54IjLvmSSlkkazUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_p-HwN54IjLvmSSlkkazUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_p-HwN54IjLvmSSlkkazUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_p-HwN54IjLvmSSlkkazUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_p-HwN54IjLvmSSlkkazUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1316/1*_p-HwN54IjLvmSSlkkazUQ.png 1316w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/658/1*_p-HwN54IjLvmSSlkkazUQ.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Feature Primitives</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">These primitives can be used by themselves or combined to create features. To make features with specified primitives we use the <code>ft.dfs</code> function (standing for deep feature synthesis). We pass in the <code>entityset</code>, the <code>target_entity</code> , which is the table where we want to add the features, the selected <code>trans_primitives</code> (transformations), and <code>agg_primitives</code> (aggregations):</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Create new features using specified primitives
features, feature_names = ft.dfs(entityset = es, target_entity = 'clients', 
                                 agg_primitives = ['mean', 'max', 'percent_true', 'last'],
                                 trans_primitives = ['years', 'month', 'subtract', 'divide'])</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The result is a dataframe of new features for each client (because we made clients the <code>target_entity</code>). For example, we have the month each client joined which is a transformation feature primitive:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:23%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 194px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 1100w, https://miro.medium.com/v2/resize:fit:388/format:webp/1*gEQkpyTDxXz21_gUPeNlMQ.png 388w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 194px" srcset="https://miro.medium.com/v2/resize:fit:640/1*gEQkpyTDxXz21_gUPeNlMQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gEQkpyTDxXz21_gUPeNlMQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gEQkpyTDxXz21_gUPeNlMQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gEQkpyTDxXz21_gUPeNlMQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gEQkpyTDxXz21_gUPeNlMQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gEQkpyTDxXz21_gUPeNlMQ.png 1100w, https://miro.medium.com/v2/resize:fit:388/1*gEQkpyTDxXz21_gUPeNlMQ.png 388w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/194/1*gEQkpyTDxXz21_gUPeNlMQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We also have a number of aggregation primitives such as the average payment amounts for each client:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:41%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 316px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 1100w, https://miro.medium.com/v2/resize:fit:632/format:webp/1*7aOkE5N-WCNQHJi1qBcqjQ.png 632w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 316px" srcset="https://miro.medium.com/v2/resize:fit:640/1*7aOkE5N-WCNQHJi1qBcqjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7aOkE5N-WCNQHJi1qBcqjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7aOkE5N-WCNQHJi1qBcqjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7aOkE5N-WCNQHJi1qBcqjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7aOkE5N-WCNQHJi1qBcqjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7aOkE5N-WCNQHJi1qBcqjQ.png 1100w, https://miro.medium.com/v2/resize:fit:632/1*7aOkE5N-WCNQHJi1qBcqjQ.png 632w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/316/1*7aOkE5N-WCNQHJi1qBcqjQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Even though we specified only a few feature primitives, featuretools created many new features by combining and stacking these primitives.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q24CTYC4x7fHj0YFwdusoQ.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*q24CTYC4x7fHj0YFwdusoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*q24CTYC4x7fHj0YFwdusoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*q24CTYC4x7fHj0YFwdusoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*q24CTYC4x7fHj0YFwdusoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*q24CTYC4x7fHj0YFwdusoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*q24CTYC4x7fHj0YFwdusoQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*q24CTYC4x7fHj0YFwdusoQ.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*q24CTYC4x7fHj0YFwdusoQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The complete dataframe has 793 columns of new features!</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Deep Feature Synthesis</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We now have all the pieces in place to understand deep feature synthesis (dfs). In fact, we already performed dfs in the previous function call! A deep feature is simply a feature made of stacking multiple primitives and dfs is the name of process that makes these features. The depth of a deep feature is the number of primitives required to make the feature.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For example, the <code>MEAN(payments.payment_amount) </code>column is a deep feature with a depth of 1 because it was created using a single aggregation. A feature with a depth of two is <code>LAST(loans(MEAN(payments.payment_amount)) </code>This is made by stacking two aggregations: LAST (most recent) on top of MEAN. This represents the average payment size of the most recent loan for each client.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:52%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 393px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 1100w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*y28-ibs-ZCpCvavVPmmZAw.png 786w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 393px" srcset="https://miro.medium.com/v2/resize:fit:640/1*y28-ibs-ZCpCvavVPmmZAw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*y28-ibs-ZCpCvavVPmmZAw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*y28-ibs-ZCpCvavVPmmZAw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*y28-ibs-ZCpCvavVPmmZAw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*y28-ibs-ZCpCvavVPmmZAw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*y28-ibs-ZCpCvavVPmmZAw.png 1100w, https://miro.medium.com/v2/resize:fit:786/1*y28-ibs-ZCpCvavVPmmZAw.png 786w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/393/1*y28-ibs-ZCpCvavVPmmZAw.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We can stack features to any depth we want, but in practice, I have never gone beyond a depth of 2. After this point, the features are difficult to interpret, but I encourage anyone interested to try <a href="http://knowyourmeme.com/memes/we-need-to-go-deeper" target="_self">“going deeper”</a>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We do not have to manually specify the feature primitives, but instead can let featuretools automatically choose features for us. To do this, we use the same <code>ft.dfs</code> function call but do not pass in any feature primitives:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Perform deep feature synthesis without specifying primitives
features, feature_names = ft.dfs(entityset=es, target_entity='clients', 
                                 max_depth = 2)

features.head()</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tewxbRVcXb_weoy_g6EfkA.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*tewxbRVcXb_weoy_g6EfkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tewxbRVcXb_weoy_g6EfkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tewxbRVcXb_weoy_g6EfkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tewxbRVcXb_weoy_g6EfkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tewxbRVcXb_weoy_g6EfkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tewxbRVcXb_weoy_g6EfkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tewxbRVcXb_weoy_g6EfkA.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*tewxbRVcXb_weoy_g6EfkA.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Featuretools has built many new features for us to use. While this process does automatically create new features, it will not replace the data scientist because we still have to figure out what to do with all these features. For example, if our goal is to predict whether or not a client will repay a loan, we could look for the features most correlated with a specified outcome. Moreover, if we have domain knowledge, we can use that to choose specific feature primitives or <a href="https://docs.featuretools.com/guides/tuning_dfs.html" target="_self">seed deep feature synthesis</a> with candidate features.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Next Steps</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Automated feature engineering has solved one problem, but created another: too many features. Although it’s difficult to say before fitting a model which of these features will be important, it’s likely not all of them will be relevant to a task we want to train our model on. Moreover,<a href="https://pdfs.semanticscholar.org/a83b/ddb34618cc68f1014ca12eef7f537825d104.pdf" target="_self"> having too many features</a> can lead to poor model performance because the less useful features drown out those that are more important.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The problem of too many features is known as the <a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality#Machine_learning" target="_self">curse of dimensionality</a>. As the number of features increases (the dimension of the data grows) it becomes more and more difficult for a model to learn the mapping between features and targets. In fact, the amount of data needed for the model to perform well <a href="https://stats.stackexchange.com/a/65380/157316" target="_self">scales exponentially with the number of features</a>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The curse of dimensionality is combated with <a href="https://machinelearningmastery.com/an-introduction-to-feature-selection/" target="_self">feature reduction (also known as feature selection)</a>: the process of removing irrelevant features. This can take on many forms: Principal Component Analysis (PCA), SelectKBest, using feature importances from a model, or auto-encoding using deep neural networks. However, <a href="https://en.wikipedia.org/wiki/Feature_selection" target="_self">feature reduction</a> is a different topic for another article. For now, we know that we can use featuretools to create numerous features from many tables with minimal effort!</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Conclusions</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Like many topics in machine learning, automated feature engineering with featuretools is a complicated concept built on simple ideas. Using concepts of entitysets, entities, and relationships, featuretools can perform deep feature synthesis to create new features. Deep feature synthesis in turn stacks feature primitives — <strong>aggregations, </strong>which act across a one-to-many relationship between tables, and <strong>transformations, </strong>functions applied to one or more columns in a single table — to build new features from multiple tables.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In future articles, I’ll show how to use this technique on a real world problem, the <a href="https://www.kaggle.com/c/home-credit-default-risk" target="_self">Home Credit Default Risk competition</a> currently being hosted on Kaggle. Stay tuned for that post, and in the meantime, read <a href="https://medium.com/machine-learning-kaggle-competition-part-one-getting-started-32fb9ff47426" target="_self">this introduction to get started</a> in the competition! I hope that you can now use automated feature engineering as an aid in a data science pipeline. Our models are only as good as the data we give them, and automated feature engineering can help to make the feature creation process more efficient.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For more information on featuretools, including advanced usage, check out the <a href="https://docs.featuretools.com/" target="_self">online documentation</a>. To see how featuretools is used in practice, read about the <a href="https://www.featurelabs.com/" target="_self">work of Feature Labs</a>, the company behind the open-source library.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">As always, I welcome feedback and constructive criticism and can be reached on Twitter <a href="http://twitter.com/koehrsen_will" target="_self">@koehrsen_will</a>.</p></div></div></div></section><?php include_once 'Elemental/footer.php'; ?>