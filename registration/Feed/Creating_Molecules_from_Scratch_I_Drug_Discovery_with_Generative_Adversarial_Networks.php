<!DOCTYPE html>
                <html>
                <head>
                    <title>Creating Molecules from Scratch I: Drug Discovery with Generative Adversarial Networks</title>
                <?php include_once 'Elemental/header.php'; ?><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><br><br><h5> This article is reformatted from originally published at <a href="https://medium.com/neuromation-blog/creating-molecules-from-scratch-i-drug-discovery-with-generative-adversarial-networks-9d42cc496fc6"><strong>TDS(Towards Data Science)</strong></a></h5></br><h5> <a href="https://medium.com/@Neuromation?source=post_page-----9d42cc496fc6--------------------------------">Author : Neuromation</a> </h5></div></div></div></section><section data-bs-version="5.1" class="content4 cid-tt5SM2WLsM" id="content4-2" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="title col-md-12 col-lg-9">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                            <strong>Creating Molecules from Scratch I: Drug Discovery with Generative Adversarial Networks</h3></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We’ve got great news: the very first paper with official Neuromation affiliation has appeared! This work, “<a href="https://pubs.acs.org/doi/10.1021/acs.molpharmaceut.7b01134" target="_self">3D Molecular Representations Based on the Wave Transform for Convolutional Neural Networks</a>”, has recently appeared in a top biomedical journal, <a href="https://pubs.acs.org/journal/mpohbp" target="_self">Molecular Pharmaceutics</a>. This paper describes the work done by our friends and partners <a href="http://insilico.com/" target="_self">Insilico Medicine</a> in close collaboration with Neuromation. We are starting to work together with Insilico on this and other exciting projects in the biomedical domain to both significantly accelerate drug discovery and improve the outcomes of clinical trials; by the way, I thank CEO of Insilico Medicine <a href="https://www.linkedin.com/in/zhavoronkov" target="_self">Alex Zhavoronkov</a> and CEO of Insilico Taiwan <a href="https://ru.linkedin.com/in/artur-kadurin-a7041097" target="_self">Artur Kadurin</a> for important additions to this post. Collaborations between top AI companies are becoming more and more common in the healthcare space. But wait — the <a href="https://www.acs.org/content/acs/en.html" target="_self">American Chemical Society’s</a> <a href="https://pubs.acs.org/journal/mpohbp" target="_self">Molecular Pharmaceutics</a>?! Doesn’t sound like a machine learning journal at all, does it? Read on…</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*dwa5nSFfTgPiUyeU. 640w, https://miro.medium.com/v2/resize:fit:720/0*dwa5nSFfTgPiUyeU. 720w, https://miro.medium.com/v2/resize:fit:750/0*dwa5nSFfTgPiUyeU. 750w, https://miro.medium.com/v2/resize:fit:786/0*dwa5nSFfTgPiUyeU. 786w, https://miro.medium.com/v2/resize:fit:828/0*dwa5nSFfTgPiUyeU. 828w, https://miro.medium.com/v2/resize:fit:1100/0*dwa5nSFfTgPiUyeU. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*dwa5nSFfTgPiUyeU. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*dwa5nSFfTgPiUyeU. 640w, https://miro.medium.com/v2/resize:fit:720/0*dwa5nSFfTgPiUyeU. 720w, https://miro.medium.com/v2/resize:fit:750/0*dwa5nSFfTgPiUyeU. 750w, https://miro.medium.com/v2/resize:fit:786/0*dwa5nSFfTgPiUyeU. 786w, https://miro.medium.com/v2/resize:fit:828/0*dwa5nSFfTgPiUyeU. 828w, https://miro.medium.com/v2/resize:fit:1100/0*dwa5nSFfTgPiUyeU. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*dwa5nSFfTgPiUyeU. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*dwa5nSFfTgPiUyeU."></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Lead Molecules: Educating the Guess</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Getting a new drug to the market is a long and tedious process; it can take many years or even decades. There are all sorts of experiments, clinical studies, and clinical trials that you have to go through. And about 90% of all clinical trials in humans fail even after the molecules have been successfully tested in animals.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">But to a first approximation, the process is as follows:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">the doctors study medical literature, in particular associations between drugs, diseases, and proteins published in other papers and clinical studies, and find out what the target for the drug should be, i.e., which protein it should bind with;</li><li class="ff3" style="font-size:22px;">after that, they can formulate what kind of properties they want from the drug: how soluble it should be, which specific structures it should have to bind with this protein, should it treat this or that kind of cancer…</li><li class="ff3" style="font-size:22px;">then they sit down and think about which molecules might have these properties; there is <em>a lot</em> to choose from on this stage: e.g., one standard database lists 72 million molecules, complete with their formulas, some properties and everything; unfortunately, it doesn’t always say whether a given molecule cures cancer, this we have to find out for ourselves;</li><li class="ff3" style="font-size:22px;">then their ideas, called <em>lead molecules</em>, or <em>leads</em>, are actually sent to the lab for experimental validation;</li><li class="ff3" style="font-size:22px;">if the lab says that the substance works, the whole clinical trial procedure can be initiated; it is still very long and tedious, and only a small percentage of drugs actually go all the way through the funnel and reach the market, but at least there is hope.</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*-jW_R9CNS3NEjnjx. 640w, https://miro.medium.com/v2/resize:fit:720/0*-jW_R9CNS3NEjnjx. 720w, https://miro.medium.com/v2/resize:fit:750/0*-jW_R9CNS3NEjnjx. 750w, https://miro.medium.com/v2/resize:fit:786/0*-jW_R9CNS3NEjnjx. 786w, https://miro.medium.com/v2/resize:fit:828/0*-jW_R9CNS3NEjnjx. 828w, https://miro.medium.com/v2/resize:fit:1100/0*-jW_R9CNS3NEjnjx. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*-jW_R9CNS3NEjnjx. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*-jW_R9CNS3NEjnjx. 640w, https://miro.medium.com/v2/resize:fit:720/0*-jW_R9CNS3NEjnjx. 720w, https://miro.medium.com/v2/resize:fit:750/0*-jW_R9CNS3NEjnjx. 750w, https://miro.medium.com/v2/resize:fit:786/0*-jW_R9CNS3NEjnjx. 786w, https://miro.medium.com/v2/resize:fit:828/0*-jW_R9CNS3NEjnjx. 828w, https://miro.medium.com/v2/resize:fit:1100/0*-jW_R9CNS3NEjnjx. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*-jW_R9CNS3NEjnjx. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*-jW_R9CNS3NEjnjx."></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://www.phrma.org/graphic/the-biopharmaceutical-research-and-development-process" target="_self">Image source</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">So where is the place of AI in this process? Naturally, we can’t hope to replace the lab or, God forbid, clinical trials: we wouldn’t want to sell a drug unless we are certain that it’s safe and confident that it is effective in a large number of patients. This certainty can only come from actual live experiments. In the future it is likely that we will be able to go from in silico (in a computer) to patients immediately with the AI-driven drug discovery pipelines but today we need to do the experiments.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Note, however, the initial stage of identifying the lead molecules. At this stage, we cannot be sure of anything, but live experiments in the lab are still very slow and expensive, so we would like to find lead molecules as accurately as we can. After all, even if the goal is to treat cancer there is no hope to check the entire endless variation of small molecules in the lab (“small” are molecules that can easily get through a cell membrane, which means basically everything smaller than a nucleic acid). 72 million is just the size of a specific database, the total number of small molecules is estimated to be between 10⁶⁰ and 10²⁰⁰, and synthesizing and testing a single new molecule in the lab may cost thousands or tens of thousands of dollars. Obviously, the early guessing stage is really, really important.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">By now you can see how it might be beneficial to apply latest AI techniques to drug discovery. We can use machine learning models to try and choose the molecules that are most likely to have desired properties.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">But when you have 72 million of something, “choosing” ceases to look like classification and gets more into the “generation” part of the spectrum. We have to basically generate a molecule from scratch, and not just some molecule, but a promising candidate for a drug. With modern generative models, we can stop searching for a needle in a haystack and design perfect needles instead:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*FBFuaOq__7M6vEb3. 640w, https://miro.medium.com/v2/resize:fit:720/0*FBFuaOq__7M6vEb3. 720w, https://miro.medium.com/v2/resize:fit:750/0*FBFuaOq__7M6vEb3. 750w, https://miro.medium.com/v2/resize:fit:786/0*FBFuaOq__7M6vEb3. 786w, https://miro.medium.com/v2/resize:fit:828/0*FBFuaOq__7M6vEb3. 828w, https://miro.medium.com/v2/resize:fit:1100/0*FBFuaOq__7M6vEb3. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*FBFuaOq__7M6vEb3. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*FBFuaOq__7M6vEb3. 640w, https://miro.medium.com/v2/resize:fit:720/0*FBFuaOq__7M6vEb3. 720w, https://miro.medium.com/v2/resize:fit:750/0*FBFuaOq__7M6vEb3. 750w, https://miro.medium.com/v2/resize:fit:786/0*FBFuaOq__7M6vEb3. 786w, https://miro.medium.com/v2/resize:fit:828/0*FBFuaOq__7M6vEb3. 828w, https://miro.medium.com/v2/resize:fit:1100/0*FBFuaOq__7M6vEb3. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*FBFuaOq__7M6vEb3. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*FBFuaOq__7M6vEb3."></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">How do we generate something from scratch? Deep learning does have a few answers when it comes to generative models; in this case, the answer turned out to be…</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Generative Adversarial Networks</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We have already briefly talked about generative adversarial networks (GANs) in <a href="https://medium.com/neuromation-io-blog/new-advances-in-generative-adversarial-networks-or-a-comment-on-karras-et-al-2017-207049cb1e7a" target="_self">a previous post</a>, but I’m sure a reminder is in order here. GANs are a class of neural networks that aim to learn to generate objects from a certain class. Previously, GANs had been mostly used to generate images: human faces as in (<a href="https://medium.com/neuromation-io-blog/new-advances-in-generative-adversarial-networks-or-a-comment-on-karras-et-al-2017-207049cb1e7a" target="_self">Karras et al., 2017</a>), photos of birds and flowers as in <a href="https://github.com/hanzhanggit/StackGAN" target="_self">StackGAN</a>, or, somewhat suprisingly, bedroom interiors, a very popular choice for GAN papers due to a commonly used part of the standard <a href="http://lsun.cs.princeton.edu/2017/" target="_self">LSUN scene understanding dataset</a>. Generation in GANs is based on a very interesting and rather commonsense idea. They have two parts that are in competition with each other:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">the objective of the <strong>generator</strong> is to generate new objects that are supposed to pass for “true” data points;</li><li class="ff3" style="font-size:22px;">while the <strong>discriminator</strong> has to decipher the tricks played by the generator and distinguish between real data points and the ones produced by the generator.</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Here is how the general scheme looks:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*MNymJpmxULbHQKVo. 640w, https://miro.medium.com/v2/resize:fit:720/0*MNymJpmxULbHQKVo. 720w, https://miro.medium.com/v2/resize:fit:750/0*MNymJpmxULbHQKVo. 750w, https://miro.medium.com/v2/resize:fit:786/0*MNymJpmxULbHQKVo. 786w, https://miro.medium.com/v2/resize:fit:828/0*MNymJpmxULbHQKVo. 828w, https://miro.medium.com/v2/resize:fit:1100/0*MNymJpmxULbHQKVo. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*MNymJpmxULbHQKVo. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*MNymJpmxULbHQKVo. 640w, https://miro.medium.com/v2/resize:fit:720/0*MNymJpmxULbHQKVo. 720w, https://miro.medium.com/v2/resize:fit:750/0*MNymJpmxULbHQKVo. 750w, https://miro.medium.com/v2/resize:fit:786/0*MNymJpmxULbHQKVo. 786w, https://miro.medium.com/v2/resize:fit:828/0*MNymJpmxULbHQKVo. 828w, https://miro.medium.com/v2/resize:fit:1100/0*MNymJpmxULbHQKVo. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*MNymJpmxULbHQKVo. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*MNymJpmxULbHQKVo."></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://deeplearning4j.org/generative-adversarial-network" target="_self">Image source</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In other words, the discriminator learns to spot the generator’s counterfeit images, while the generator learns to fool the discriminator. I refer to, e.g., <a href="https://medium.com/@ageitgey/abusing-generative-adversarial-networks-to-make-8-bit-pixel-art-e45d9b96cee7" target="_self">this post</a> for a simple and fun introduction to GANs.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We at Neuromation are following GAN research with great interest due to many possible exciting applications. For example, conditional GANs have been used for image transformations with the explicit purpose of enhancing images; see, e.g., image de-raining recently implemented with GANs <a href="https://arxiv.org/abs/1706.09138" target="_self">in this work</a>. This ties in perfectly with our own ideas of using synthetic data for computer vision: with a proper conditional GAN for image enhancement, we might be able to improve synthetic (3D-rendered) images and make them more like real photos, especially in small details. In <a href="https://medium.com/neuromation-io-blog/new-advances-in-generative-adversarial-networks-or-a-comment-on-karras-et-al-2017-207049cb1e7a" target="_self">the post I referred to</a>, we saw how NVIDIA researchers introduced a nice way to learn GANs progressively, from small images to large ones.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">But wait. All of this so far makes a lot of sense for images. Maybe it also makes sense for some other relatively “continuous” kinds of data. But molecules? The atomic structure is totally not continuous, and GANs are notoriously hard to train for discrete structures. Still, GANs did prove to work for generating molecules as well. Let’s find out how.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Adversarial Autoencoders</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Our recent paper on molecular representations is actually a part of a long line of research done by our good friends and partners, Insilico Medicine. It began with Insilico’s paper “<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5355231/" target="_self">The cornucopia of meaningful leads: Applying deep adversarial autoencoders for new molecule development in oncology</a>”, whose lead author Artur Kadurin is a world-class expert on deep learning, one of <a href="http://www.insilico.com" target="_self">Insilico Medicine</a>’s <a href="http://www.pharma.ai" target="_self">Pharma.AI</a> team on deep learning for molecular biology, recently appointed CEO of Insilico Taiwan… and my Ph.D. student.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In this work, Kadurin et al. presented an architecture for generating lead molecules based on a variation of the GAN idea called <a href="https://arxiv.org/abs/1511.05644" target="_self">Adversarial Autoencoders</a> (AAE). In AAE, the idea is to learn to generate objects from their <em>latent representations</em>. Generally speaking, <em>autoencoders</em> are neural architectures that take an object as input… and try to return the same object as output. Doesn’t sound too hard, but the idea is that in the middle of the architecture, the input must go through a middle layer that learns a latent representation, i.e., a set of features that succinctly encode the input in such a way that afterwards subsequent layers can decode the object back:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*ovqbOqz_q6FERZCn. 640w, https://miro.medium.com/v2/resize:fit:720/0*ovqbOqz_q6FERZCn. 720w, https://miro.medium.com/v2/resize:fit:750/0*ovqbOqz_q6FERZCn. 750w, https://miro.medium.com/v2/resize:fit:786/0*ovqbOqz_q6FERZCn. 786w, https://miro.medium.com/v2/resize:fit:828/0*ovqbOqz_q6FERZCn. 828w, https://miro.medium.com/v2/resize:fit:1100/0*ovqbOqz_q6FERZCn. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*ovqbOqz_q6FERZCn. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*ovqbOqz_q6FERZCn. 640w, https://miro.medium.com/v2/resize:fit:720/0*ovqbOqz_q6FERZCn. 720w, https://miro.medium.com/v2/resize:fit:750/0*ovqbOqz_q6FERZCn. 750w, https://miro.medium.com/v2/resize:fit:786/0*ovqbOqz_q6FERZCn. 786w, https://miro.medium.com/v2/resize:fit:828/0*ovqbOqz_q6FERZCn. 828w, https://miro.medium.com/v2/resize:fit:1100/0*ovqbOqz_q6FERZCn. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*ovqbOqz_q6FERZCn. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*ovqbOqz_q6FERZCn."></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://towardsdatascience.com/applied-deep-learning-part-3-autoencoders-1c083af4d798" target="_self">Image source</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Either the middle layer is simply smaller (has lower dimension) than input and output, or the autoencoder uses special regularization techniques, but in any case it’s impossible to simply copy the input through all layers, and the autoencoder has to extract the really important stuff.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">So what did Kadurin et al. do? They took a conditional adversarial autoencoder and trained it to generate fingerprints of molecules, using and serving desired properties as conditions. Here is the general model architecture from (Kadurin et al., 2017):</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*KzKdBlERyNuY_RXd. 640w, https://miro.medium.com/v2/resize:fit:720/0*KzKdBlERyNuY_RXd. 720w, https://miro.medium.com/v2/resize:fit:750/0*KzKdBlERyNuY_RXd. 750w, https://miro.medium.com/v2/resize:fit:786/0*KzKdBlERyNuY_RXd. 786w, https://miro.medium.com/v2/resize:fit:828/0*KzKdBlERyNuY_RXd. 828w, https://miro.medium.com/v2/resize:fit:1100/0*KzKdBlERyNuY_RXd. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*KzKdBlERyNuY_RXd. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*KzKdBlERyNuY_RXd. 640w, https://miro.medium.com/v2/resize:fit:720/0*KzKdBlERyNuY_RXd. 720w, https://miro.medium.com/v2/resize:fit:750/0*KzKdBlERyNuY_RXd. 750w, https://miro.medium.com/v2/resize:fit:786/0*KzKdBlERyNuY_RXd. 786w, https://miro.medium.com/v2/resize:fit:828/0*KzKdBlERyNuY_RXd. 828w, https://miro.medium.com/v2/resize:fit:1100/0*KzKdBlERyNuY_RXd. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*KzKdBlERyNuY_RXd. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*KzKdBlERyNuY_RXd."></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Image source: (Kadurin et al., 2017)</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Looks just like the autoencoder above, but with two important additions in the middle:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;"><mark>on top, there is a discriminator that tries to distinguish the distribution of latent representations from some standard distribution, e.g., a Gaussian; this is the main idea of AAE: if you can make the distribution of latent codes indistinguishable from some standard distribution, it means that you can then </mark><mark>sample</mark><mark> from this distribution and generate reasonable samples through the decoder;</mark></li><li class="ff3" style="font-size:22px;">on the bottom, there is a condition that in this case encodes desired properties of the molecule; we train on the molecules with known properties, and the problem is then to generate molecules with desired (perhaps even never before seen) combinations of properties.</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">There is still that nagging question about the representations, though. How do we generate discrete structures like molecules? We will discuss molecular representations in much greater detail in the next post; here let me simply mention that this work used a standard representation of a molecule as a <a href="http://www.dalkescientific.com/writings/NBN/fingerprints.html" target="_self">MACCS fingerprint</a>, a set of binary characteristics of the molecule such as “how many oxygens is has” or “does it have a ring of size 4”.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Basically, the problem becomes to “translate” the condition, i.e., desired properties of a molecule, into more “low-level” properties of the molecular structure encoded into their MACCS fingerprints. Then a simple screening of the database can find molecules with the fingerprints most similar to generated ones.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">At the time that was the first peer-reviewed paper showing that GANs can generate novel molecules. The submission was made in June 2016 and it was accepted in December 2016. In 2017 the community started to notice:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*wWlxq_gYBOMZsfVf. 640w, https://miro.medium.com/v2/resize:fit:720/0*wWlxq_gYBOMZsfVf. 720w, https://miro.medium.com/v2/resize:fit:750/0*wWlxq_gYBOMZsfVf. 750w, https://miro.medium.com/v2/resize:fit:786/0*wWlxq_gYBOMZsfVf. 786w, https://miro.medium.com/v2/resize:fit:828/0*wWlxq_gYBOMZsfVf. 828w, https://miro.medium.com/v2/resize:fit:1100/0*wWlxq_gYBOMZsfVf. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*wWlxq_gYBOMZsfVf. 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*wWlxq_gYBOMZsfVf. 640w, https://miro.medium.com/v2/resize:fit:720/0*wWlxq_gYBOMZsfVf. 720w, https://miro.medium.com/v2/resize:fit:750/0*wWlxq_gYBOMZsfVf. 750w, https://miro.medium.com/v2/resize:fit:786/0*wWlxq_gYBOMZsfVf. 786w, https://miro.medium.com/v2/resize:fit:828/0*wWlxq_gYBOMZsfVf. 828w, https://miro.medium.com/v2/resize:fit:1100/0*wWlxq_gYBOMZsfVf. 1100w, https://miro.medium.com/v2/resize:fit:1400/0*wWlxq_gYBOMZsfVf. 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*wWlxq_gYBOMZsfVf."></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">It turned out that the resulting molecules do look interesting…</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Conclusion</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This post is getting a bit long; let’s take it one step at a time. We will get to our recent paper in the next installment, and now let us summarize what we’ve seen so far.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Since the deep learning revolution, deep neural networks have been revolutionizing one field after another. In this post, we have seen how modern deep learning techniques are transforming molecular biology and drug discovery. Constructions such as adversarial autoencoders are designed to generate high-quality objects of various nature, and it’s not a huge wonder that such approaches work for molecular biology as well. I have no doubt that in the future, these or similar techniques will bring us closer to truly personalized medicine.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">So what next? Insilico has already generated several very promising candidates for really useful drugs. Right now they are undergoing experimental validation in the lab. Who know, perhaps in the next few years we will see new drugs identified by deep learning models. Fingers crossed.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>Sergey NikolenkoChief Research Officer, Neuromation</em></p></div></div></div></section><?php include_once 'Elemental/footer.php'; ?>