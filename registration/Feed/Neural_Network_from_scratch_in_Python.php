<!DOCTYPE html>
                <html>
                <head>
                    <title>Neural Network from scratch in Python</title>
                <?php include_once 'Elemental/header.php'; ?><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><br><br><h5> This article is reformatted from originally published at <a href="https://towardsdatascience.com/math-neural-network-from-scratch-in-python-d6da9f29ce65"><strong>TDS(Towards Data Science)</strong></a></h5></br><h5> <a href="https://omaraflak.medium.com/?source=post_page-----d6da9f29ce65--------------------------------">Author : Omar Aflak</a> </h5></div></div></div></section><section data-bs-version="5.1" class="content4 cid-tt5SM2WLsM" id="content4-2" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="title col-md-12 col-lg-9">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                            <strong>Neural Network from scratch in Python</h3></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5 text-muted">Make your own machine learning library.</h4></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*YtYVlwMAM7s7cwgI 640w, https://miro.medium.com/v2/resize:fit:720/0*YtYVlwMAM7s7cwgI 720w, https://miro.medium.com/v2/resize:fit:750/0*YtYVlwMAM7s7cwgI 750w, https://miro.medium.com/v2/resize:fit:786/0*YtYVlwMAM7s7cwgI 786w, https://miro.medium.com/v2/resize:fit:828/0*YtYVlwMAM7s7cwgI 828w, https://miro.medium.com/v2/resize:fit:1100/0*YtYVlwMAM7s7cwgI 1100w, https://miro.medium.com/v2/resize:fit:1400/0*YtYVlwMAM7s7cwgI 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*YtYVlwMAM7s7cwgI 640w, https://miro.medium.com/v2/resize:fit:720/0*YtYVlwMAM7s7cwgI 720w, https://miro.medium.com/v2/resize:fit:750/0*YtYVlwMAM7s7cwgI 750w, https://miro.medium.com/v2/resize:fit:786/0*YtYVlwMAM7s7cwgI 786w, https://miro.medium.com/v2/resize:fit:828/0*YtYVlwMAM7s7cwgI 828w, https://miro.medium.com/v2/resize:fit:1100/0*YtYVlwMAM7s7cwgI 1100w, https://miro.medium.com/v2/resize:fit:1400/0*YtYVlwMAM7s7cwgI 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*YtYVlwMAM7s7cwgI"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Photo by <a href="https://unsplash.com/@cadop?utm_source=medium&utm_medium=referral" target="_self">Mathew Schwartz</a> on <a href="https://unsplash.com?utm_source=medium&utm_medium=referral" target="_self">Unsplash</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In this post we will go through the mathematics of machine learning and code from scratch, in Python, a small library to build neural networks with a variety of layers (Fully Connected, Convolutional, etc.). Eventually, we will be able to create networks in a modular fashion:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:89%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 1100w, https://miro.medium.com/v2/resize:fit:1308/format:webp/1*Ld6m0dsfSkJMnbXaoIAOVw.png 1308w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px" srcset="https://miro.medium.com/v2/resize:fit:640/1*Ld6m0dsfSkJMnbXaoIAOVw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ld6m0dsfSkJMnbXaoIAOVw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ld6m0dsfSkJMnbXaoIAOVw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ld6m0dsfSkJMnbXaoIAOVw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ld6m0dsfSkJMnbXaoIAOVw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ld6m0dsfSkJMnbXaoIAOVw.png 1100w, https://miro.medium.com/v2/resize:fit:1308/1*Ld6m0dsfSkJMnbXaoIAOVw.png 1308w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/654/1*Ld6m0dsfSkJMnbXaoIAOVw.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">3-layer neural network</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I’m assuming you already have <em>some</em> knowledge about neural networks. The purpose here is not to explain why we make these models, but to show <strong>how to make a proper implementation</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Layer by Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We need to keep in mind the big picture here :</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ol><li class="ff3" style="font-size:22px;">We feed <strong>input</strong> data into the neural network.</li><li class="ff3" style="font-size:22px;">The data flows <strong>from layer to layer </strong>until we have the <strong>output</strong>.</li><li class="ff3" style="font-size:22px;">Once we have the output, we can calculate the <strong>error </strong>which is a <strong>scalar</strong>.</li><li class="ff3" style="font-size:22px;">Finally we can adjust a given parameter (weight or bias) by subtracting the <strong>derivative</strong> of the error with respect to the<strong> </strong>parameter itself.</li><li class="ff3" style="font-size:22px;">We iterate through that process.</li></ol></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The most important step is the <strong>4th</strong>. We want to be able to have as many layers as we want, and of any type. But if we modify/add/remove one layer from the network, the output of the network is going to change, which is going to change the error, which is going to change the derivative of the error with respect to the parameters. We need to be able to compute the derivatives regardless of the network architecture, regardless of the activation functions, regardless of the loss we use.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In order to achieve that, we must implement <strong>each layer separately</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">What every layer should implement</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Every layer that we might create (fully connected, convolutional, maxpooling, dropout, etc.) have at least 2 things in common: <strong>input </strong>and <strong>output </strong>data.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:85%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 626px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*3cUc4jsQlHsoovn9.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*3cUc4jsQlHsoovn9.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*3cUc4jsQlHsoovn9.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*3cUc4jsQlHsoovn9.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*3cUc4jsQlHsoovn9.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*3cUc4jsQlHsoovn9.png 1100w, https://miro.medium.com/v2/resize:fit:1252/format:webp/0*3cUc4jsQlHsoovn9.png 1252w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 626px" srcset="https://miro.medium.com/v2/resize:fit:640/0*3cUc4jsQlHsoovn9.png 640w, https://miro.medium.com/v2/resize:fit:720/0*3cUc4jsQlHsoovn9.png 720w, https://miro.medium.com/v2/resize:fit:750/0*3cUc4jsQlHsoovn9.png 750w, https://miro.medium.com/v2/resize:fit:786/0*3cUc4jsQlHsoovn9.png 786w, https://miro.medium.com/v2/resize:fit:828/0*3cUc4jsQlHsoovn9.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*3cUc4jsQlHsoovn9.png 1100w, https://miro.medium.com/v2/resize:fit:1252/0*3cUc4jsQlHsoovn9.png 1252w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/626/0*3cUc4jsQlHsoovn9.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7"><strong>Forward propagation</strong></h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We can already emphasize one important point which is: <strong>the output of one layer is the input of the next one</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:92%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 676px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 1100w, https://miro.medium.com/v2/resize:fit:1352/format:webp/1*ddDKxWSAYci2dHaG3O_DOg.png 1352w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 676px" srcset="https://miro.medium.com/v2/resize:fit:640/1*ddDKxWSAYci2dHaG3O_DOg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ddDKxWSAYci2dHaG3O_DOg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ddDKxWSAYci2dHaG3O_DOg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ddDKxWSAYci2dHaG3O_DOg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ddDKxWSAYci2dHaG3O_DOg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ddDKxWSAYci2dHaG3O_DOg.png 1100w, https://miro.medium.com/v2/resize:fit:1352/1*ddDKxWSAYci2dHaG3O_DOg.png 1352w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/676/1*ddDKxWSAYci2dHaG3O_DOg.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is called <strong>forward propagation. </strong>Essentially, we give the input data to the first layer, then the output of every layer becomes the input of the next layer until we reach the end of the network. By comparing the result of the network (Y) with the desired output (let’s say Y*), we can calculate en error <strong>E</strong>. The goal is to <strong>minimize</strong> that error by changing the parameters in the network. That is backward propagation<strong> </strong>(backpropagation).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Gradient Descent</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is a quick <strong>reminder</strong>, if you need to learn more about gradient descent there are tons of resources on the internet.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Basically, we want to change some parameter in the network (call it <strong>w</strong>) so that the total error <strong>E decreases</strong>. There is a clever way to do it (not randomly) which is the following :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:40%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 310px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*MZYPbIwBn5SOEpG7.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*MZYPbIwBn5SOEpG7.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*MZYPbIwBn5SOEpG7.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*MZYPbIwBn5SOEpG7.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*MZYPbIwBn5SOEpG7.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*MZYPbIwBn5SOEpG7.png 1100w, https://miro.medium.com/v2/resize:fit:620/format:webp/0*MZYPbIwBn5SOEpG7.png 620w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 310px" srcset="https://miro.medium.com/v2/resize:fit:640/0*MZYPbIwBn5SOEpG7.png 640w, https://miro.medium.com/v2/resize:fit:720/0*MZYPbIwBn5SOEpG7.png 720w, https://miro.medium.com/v2/resize:fit:750/0*MZYPbIwBn5SOEpG7.png 750w, https://miro.medium.com/v2/resize:fit:786/0*MZYPbIwBn5SOEpG7.png 786w, https://miro.medium.com/v2/resize:fit:828/0*MZYPbIwBn5SOEpG7.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*MZYPbIwBn5SOEpG7.png 1100w, https://miro.medium.com/v2/resize:fit:620/0*MZYPbIwBn5SOEpG7.png 620w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/310/0*MZYPbIwBn5SOEpG7.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Where <strong>α </strong>is a parameter in the range [0,1] that we set and that is called the <strong>learning rate</strong>. Anyway, the important thing here is <strong>∂E/∂w </strong>(the derivative of E with respect to w). <strong>We need to be able to find the value of that expression for any parameter of the network regardless of its architecture.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Backward propagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Suppose that we give a layer the <strong>derivative of the error with respect to its output</strong> (∂E/∂Y), then it must be able to provide the <strong>derivative of the error with respect to its input </strong>(∂E/∂X).</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*bL0jVGoQiH_TsrvT.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*bL0jVGoQiH_TsrvT.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*bL0jVGoQiH_TsrvT.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*bL0jVGoQiH_TsrvT.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*bL0jVGoQiH_TsrvT.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*bL0jVGoQiH_TsrvT.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bL0jVGoQiH_TsrvT.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*bL0jVGoQiH_TsrvT.png 640w, https://miro.medium.com/v2/resize:fit:720/0*bL0jVGoQiH_TsrvT.png 720w, https://miro.medium.com/v2/resize:fit:750/0*bL0jVGoQiH_TsrvT.png 750w, https://miro.medium.com/v2/resize:fit:786/0*bL0jVGoQiH_TsrvT.png 786w, https://miro.medium.com/v2/resize:fit:828/0*bL0jVGoQiH_TsrvT.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*bL0jVGoQiH_TsrvT.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*bL0jVGoQiH_TsrvT.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*bL0jVGoQiH_TsrvT.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Remember that <code>E</code> is a <strong>scalar </strong>(a number)<strong> </strong>and <code>X</code> and <code>Y</code> are <strong>matrices</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:71%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*KYFYEbu_o9j1_a5w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*KYFYEbu_o9j1_a5w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*KYFYEbu_o9j1_a5w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*KYFYEbu_o9j1_a5w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*KYFYEbu_o9j1_a5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*KYFYEbu_o9j1_a5w.png 1100w, https://miro.medium.com/v2/resize:fit:1052/format:webp/0*KYFYEbu_o9j1_a5w.png 1052w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" srcset="https://miro.medium.com/v2/resize:fit:640/0*KYFYEbu_o9j1_a5w.png 640w, https://miro.medium.com/v2/resize:fit:720/0*KYFYEbu_o9j1_a5w.png 720w, https://miro.medium.com/v2/resize:fit:750/0*KYFYEbu_o9j1_a5w.png 750w, https://miro.medium.com/v2/resize:fit:786/0*KYFYEbu_o9j1_a5w.png 786w, https://miro.medium.com/v2/resize:fit:828/0*KYFYEbu_o9j1_a5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*KYFYEbu_o9j1_a5w.png 1100w, https://miro.medium.com/v2/resize:fit:1052/0*KYFYEbu_o9j1_a5w.png 1052w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/526/0*KYFYEbu_o9j1_a5w.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Let’s forget about ∂E/∂X for now. The trick here, is that if we have access to ∂E/∂Y we can very easily calculate ∂E/∂W (if the layer has any trainable parameters) <strong>without knowing anything about the network architecture !</strong> We simply use the chain rule :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:42%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 325px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*3xceKA-7b2oNbE4T.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*3xceKA-7b2oNbE4T.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*3xceKA-7b2oNbE4T.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*3xceKA-7b2oNbE4T.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*3xceKA-7b2oNbE4T.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*3xceKA-7b2oNbE4T.png 1100w, https://miro.medium.com/v2/resize:fit:650/format:webp/0*3xceKA-7b2oNbE4T.png 650w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 325px" srcset="https://miro.medium.com/v2/resize:fit:640/0*3xceKA-7b2oNbE4T.png 640w, https://miro.medium.com/v2/resize:fit:720/0*3xceKA-7b2oNbE4T.png 720w, https://miro.medium.com/v2/resize:fit:750/0*3xceKA-7b2oNbE4T.png 750w, https://miro.medium.com/v2/resize:fit:786/0*3xceKA-7b2oNbE4T.png 786w, https://miro.medium.com/v2/resize:fit:828/0*3xceKA-7b2oNbE4T.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*3xceKA-7b2oNbE4T.png 1100w, https://miro.medium.com/v2/resize:fit:650/0*3xceKA-7b2oNbE4T.png 650w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/325/0*3xceKA-7b2oNbE4T.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The unknown is <strong>∂y_j/∂w</strong> which totally depends on how the layer is computing its output. So if every layer have access to ∂E/∂Y, where Y is its own output, then we can update our parameters !</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">But why ∂E/∂X ?</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Don’t forget, the output of one layer is the input of the next layer. Which means ∂E/∂X for one layer is ∂E/∂Y for the previous layer ! That’s it ! It’s just a clever way to propagate the error ! Again, we can use the chain rule :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:43%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 329px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Of8qDiWo31MK-MU0.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Of8qDiWo31MK-MU0.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Of8qDiWo31MK-MU0.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Of8qDiWo31MK-MU0.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Of8qDiWo31MK-MU0.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Of8qDiWo31MK-MU0.png 1100w, https://miro.medium.com/v2/resize:fit:658/format:webp/0*Of8qDiWo31MK-MU0.png 658w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 329px" srcset="https://miro.medium.com/v2/resize:fit:640/0*Of8qDiWo31MK-MU0.png 640w, https://miro.medium.com/v2/resize:fit:720/0*Of8qDiWo31MK-MU0.png 720w, https://miro.medium.com/v2/resize:fit:750/0*Of8qDiWo31MK-MU0.png 750w, https://miro.medium.com/v2/resize:fit:786/0*Of8qDiWo31MK-MU0.png 786w, https://miro.medium.com/v2/resize:fit:828/0*Of8qDiWo31MK-MU0.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*Of8qDiWo31MK-MU0.png 1100w, https://miro.medium.com/v2/resize:fit:658/0*Of8qDiWo31MK-MU0.png 658w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/329/0*Of8qDiWo31MK-MU0.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is <em>very</em> important, it’s the <em>key</em> to understand backpropagation ! After that, we’ll be able to code a Deep Convolutional Neural Network from scratch in no time !</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Diagram to understand backpropagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is what I described earlier. Layer 3 is going to update its parameters using ∂E/∂Y, and is then going to pass ∂E/∂H2 to the previous layer, which is its own “∂E/∂Y”. Layer 2 is then going to do the same, and so on and so forth.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0QPRST83oBicKPE_R4biJA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0QPRST83oBicKPE_R4biJA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0QPRST83oBicKPE_R4biJA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0QPRST83oBicKPE_R4biJA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0QPRST83oBicKPE_R4biJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0QPRST83oBicKPE_R4biJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QPRST83oBicKPE_R4biJA.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*0QPRST83oBicKPE_R4biJA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0QPRST83oBicKPE_R4biJA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0QPRST83oBicKPE_R4biJA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0QPRST83oBicKPE_R4biJA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0QPRST83oBicKPE_R4biJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0QPRST83oBicKPE_R4biJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0QPRST83oBicKPE_R4biJA.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*0QPRST83oBicKPE_R4biJA.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This may seem abstract here, but it will get very clear when we will apply this to a specific type of layer. Speaking of <em>abstract</em>, now is a good time to write our first python class.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Abstract Base Class : Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The abstract class <em>Layer</em>, which all other layers will inherit from, handles simple properties which are an <strong>input</strong>, an <strong>output</strong>, and both a <strong>forward</strong> and <strong>backward</strong> methods.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre># Base class
class Layer:
    def __init__(self):
        self.input = None
        self.output = None

    # computes the output Y of a layer for a given input X
    def forward_propagation(self, input):
        raise NotImplementedError

    # computes dE/dX for a given dE/dY (and update parameters if any)
    def backward_propagation(self, output_error, learning_rate):
        raise NotImplementedError</pre></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">3-layer neural network</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">As you can see there is an extra parameter in <code>backward_propagation</code> that I didn’t mention, it is the <code>learning_rate</code>. This parameter should be something like an update policy, or an optimizer as they call it in Keras, but for the sake of simplicity we’re simply going to pass a learning rate and update our parameters using gradient descent.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Fully Connected Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Now let's define and implement the first type of layer: fully connected layer or FC layer. FC layers are the most basic layers as every input neurons are connected to every output neurons.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:58%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 438px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 1100w, https://miro.medium.com/v2/resize:fit:876/format:webp/1*jOObSF4HAB5VL5wO6petqA.png 876w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 438px" srcset="https://miro.medium.com/v2/resize:fit:640/1*jOObSF4HAB5VL5wO6petqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jOObSF4HAB5VL5wO6petqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jOObSF4HAB5VL5wO6petqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jOObSF4HAB5VL5wO6petqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jOObSF4HAB5VL5wO6petqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jOObSF4HAB5VL5wO6petqA.png 1100w, https://miro.medium.com/v2/resize:fit:876/1*jOObSF4HAB5VL5wO6petqA.png 876w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/438/1*jOObSF4HAB5VL5wO6petqA.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Forward Propagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The value of each output neuron can be calculated as the following :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:44%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 337px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Ec9fiXkNOoA5Z2v5.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Ec9fiXkNOoA5Z2v5.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Ec9fiXkNOoA5Z2v5.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Ec9fiXkNOoA5Z2v5.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Ec9fiXkNOoA5Z2v5.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Ec9fiXkNOoA5Z2v5.png 1100w, https://miro.medium.com/v2/resize:fit:674/format:webp/0*Ec9fiXkNOoA5Z2v5.png 674w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 337px" srcset="https://miro.medium.com/v2/resize:fit:640/0*Ec9fiXkNOoA5Z2v5.png 640w, https://miro.medium.com/v2/resize:fit:720/0*Ec9fiXkNOoA5Z2v5.png 720w, https://miro.medium.com/v2/resize:fit:750/0*Ec9fiXkNOoA5Z2v5.png 750w, https://miro.medium.com/v2/resize:fit:786/0*Ec9fiXkNOoA5Z2v5.png 786w, https://miro.medium.com/v2/resize:fit:828/0*Ec9fiXkNOoA5Z2v5.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*Ec9fiXkNOoA5Z2v5.png 1100w, https://miro.medium.com/v2/resize:fit:674/0*Ec9fiXkNOoA5Z2v5.png 674w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/337/0*Ec9fiXkNOoA5Z2v5.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">With matrices, we can compute this formula for every output neuron in one shot using a <strong>dot product</strong> :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*qTBPwmzIjBOGKpXH.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*qTBPwmzIjBOGKpXH.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*qTBPwmzIjBOGKpXH.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*qTBPwmzIjBOGKpXH.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*qTBPwmzIjBOGKpXH.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*qTBPwmzIjBOGKpXH.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qTBPwmzIjBOGKpXH.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*qTBPwmzIjBOGKpXH.png 640w, https://miro.medium.com/v2/resize:fit:720/0*qTBPwmzIjBOGKpXH.png 720w, https://miro.medium.com/v2/resize:fit:750/0*qTBPwmzIjBOGKpXH.png 750w, https://miro.medium.com/v2/resize:fit:786/0*qTBPwmzIjBOGKpXH.png 786w, https://miro.medium.com/v2/resize:fit:828/0*qTBPwmzIjBOGKpXH.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*qTBPwmzIjBOGKpXH.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*qTBPwmzIjBOGKpXH.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*qTBPwmzIjBOGKpXH.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:32%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 253px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*FsJQ82GmKlV2X22z.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*FsJQ82GmKlV2X22z.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*FsJQ82GmKlV2X22z.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*FsJQ82GmKlV2X22z.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*FsJQ82GmKlV2X22z.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*FsJQ82GmKlV2X22z.png 1100w, https://miro.medium.com/v2/resize:fit:506/format:webp/0*FsJQ82GmKlV2X22z.png 506w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 253px" srcset="https://miro.medium.com/v2/resize:fit:640/0*FsJQ82GmKlV2X22z.png 640w, https://miro.medium.com/v2/resize:fit:720/0*FsJQ82GmKlV2X22z.png 720w, https://miro.medium.com/v2/resize:fit:750/0*FsJQ82GmKlV2X22z.png 750w, https://miro.medium.com/v2/resize:fit:786/0*FsJQ82GmKlV2X22z.png 786w, https://miro.medium.com/v2/resize:fit:828/0*FsJQ82GmKlV2X22z.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*FsJQ82GmKlV2X22z.png 1100w, https://miro.medium.com/v2/resize:fit:506/0*FsJQ82GmKlV2X22z.png 506w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/253/0*FsJQ82GmKlV2X22z.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We’re done with the forward pass. Now let’s do the backward pass of the FC layer.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>Note that I’m not using any activation function yet, that’s because we will implement it in a separate layer!</em></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Backward Propagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">As we said, suppose we<mark> have a matrix containing the derivative of the error with respect to </mark><mark>that layer’s output </mark><mark>(∂E/∂Y). We</mark> need :</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ol><li class="ff3" style="font-size:22px;">The derivative of the error with respect to the parameters (∂E/∂W, ∂E/∂B)</li><li class="ff3" style="font-size:22px;">The derivative of the error with respect to the input (∂E/∂X)</li></ol></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Let's calculate ∂E/∂W. This matrix should be the same size as W itself : <code>ixj</code> where <code>i</code> is the number of input neurons and <code>j</code> the number of output neurons. We need <strong>one gradient for every weight</strong> :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:53%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 401px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*PiVZ-czmfvBaAFSe.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*PiVZ-czmfvBaAFSe.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*PiVZ-czmfvBaAFSe.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*PiVZ-czmfvBaAFSe.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*PiVZ-czmfvBaAFSe.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*PiVZ-czmfvBaAFSe.png 1100w, https://miro.medium.com/v2/resize:fit:802/format:webp/0*PiVZ-czmfvBaAFSe.png 802w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 401px" srcset="https://miro.medium.com/v2/resize:fit:640/0*PiVZ-czmfvBaAFSe.png 640w, https://miro.medium.com/v2/resize:fit:720/0*PiVZ-czmfvBaAFSe.png 720w, https://miro.medium.com/v2/resize:fit:750/0*PiVZ-czmfvBaAFSe.png 750w, https://miro.medium.com/v2/resize:fit:786/0*PiVZ-czmfvBaAFSe.png 786w, https://miro.medium.com/v2/resize:fit:828/0*PiVZ-czmfvBaAFSe.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*PiVZ-czmfvBaAFSe.png 1100w, https://miro.medium.com/v2/resize:fit:802/0*PiVZ-czmfvBaAFSe.png 802w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/401/0*PiVZ-czmfvBaAFSe.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Using the chain rule stated earlier, we can write :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:84%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 621px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*cKYlxf87ZwkKtnrt.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*cKYlxf87ZwkKtnrt.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*cKYlxf87ZwkKtnrt.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*cKYlxf87ZwkKtnrt.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*cKYlxf87ZwkKtnrt.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*cKYlxf87ZwkKtnrt.png 1100w, https://miro.medium.com/v2/resize:fit:1242/format:webp/0*cKYlxf87ZwkKtnrt.png 1242w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 621px" srcset="https://miro.medium.com/v2/resize:fit:640/0*cKYlxf87ZwkKtnrt.png 640w, https://miro.medium.com/v2/resize:fit:720/0*cKYlxf87ZwkKtnrt.png 720w, https://miro.medium.com/v2/resize:fit:750/0*cKYlxf87ZwkKtnrt.png 750w, https://miro.medium.com/v2/resize:fit:786/0*cKYlxf87ZwkKtnrt.png 786w, https://miro.medium.com/v2/resize:fit:828/0*cKYlxf87ZwkKtnrt.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*cKYlxf87ZwkKtnrt.png 1100w, https://miro.medium.com/v2/resize:fit:1242/0*cKYlxf87ZwkKtnrt.png 1242w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/621/0*cKYlxf87ZwkKtnrt.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Therefore,</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:70%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 521px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*sEeQVqIapym6O9VH.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*sEeQVqIapym6O9VH.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*sEeQVqIapym6O9VH.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*sEeQVqIapym6O9VH.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*sEeQVqIapym6O9VH.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*sEeQVqIapym6O9VH.png 1100w, https://miro.medium.com/v2/resize:fit:1042/format:webp/0*sEeQVqIapym6O9VH.png 1042w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 521px" srcset="https://miro.medium.com/v2/resize:fit:640/0*sEeQVqIapym6O9VH.png 640w, https://miro.medium.com/v2/resize:fit:720/0*sEeQVqIapym6O9VH.png 720w, https://miro.medium.com/v2/resize:fit:750/0*sEeQVqIapym6O9VH.png 750w, https://miro.medium.com/v2/resize:fit:786/0*sEeQVqIapym6O9VH.png 786w, https://miro.medium.com/v2/resize:fit:828/0*sEeQVqIapym6O9VH.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*sEeQVqIapym6O9VH.png 1100w, https://miro.medium.com/v2/resize:fit:1042/0*sEeQVqIapym6O9VH.png 1042w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/521/0*sEeQVqIapym6O9VH.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">That’s it we have the first formula to update the weights! Now let's calculate ∂E/∂B.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:69%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 516px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*sJVXt05jf2cgd_Ys.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*sJVXt05jf2cgd_Ys.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*sJVXt05jf2cgd_Ys.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*sJVXt05jf2cgd_Ys.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*sJVXt05jf2cgd_Ys.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*sJVXt05jf2cgd_Ys.png 1100w, https://miro.medium.com/v2/resize:fit:1032/format:webp/0*sJVXt05jf2cgd_Ys.png 1032w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 516px" srcset="https://miro.medium.com/v2/resize:fit:640/0*sJVXt05jf2cgd_Ys.png 640w, https://miro.medium.com/v2/resize:fit:720/0*sJVXt05jf2cgd_Ys.png 720w, https://miro.medium.com/v2/resize:fit:750/0*sJVXt05jf2cgd_Ys.png 750w, https://miro.medium.com/v2/resize:fit:786/0*sJVXt05jf2cgd_Ys.png 786w, https://miro.medium.com/v2/resize:fit:828/0*sJVXt05jf2cgd_Ys.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*sJVXt05jf2cgd_Ys.png 1100w, https://miro.medium.com/v2/resize:fit:1032/0*sJVXt05jf2cgd_Ys.png 1032w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/516/0*sJVXt05jf2cgd_Ys.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Again ∂E/∂B needs to be of the same size as B itself, one gradient per bias. We can use the chain rule again :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:75%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 557px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*ud43sxuKpgPo9Rlo.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*ud43sxuKpgPo9Rlo.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*ud43sxuKpgPo9Rlo.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*ud43sxuKpgPo9Rlo.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*ud43sxuKpgPo9Rlo.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*ud43sxuKpgPo9Rlo.png 1100w, https://miro.medium.com/v2/resize:fit:1114/format:webp/0*ud43sxuKpgPo9Rlo.png 1114w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 557px" srcset="https://miro.medium.com/v2/resize:fit:640/0*ud43sxuKpgPo9Rlo.png 640w, https://miro.medium.com/v2/resize:fit:720/0*ud43sxuKpgPo9Rlo.png 720w, https://miro.medium.com/v2/resize:fit:750/0*ud43sxuKpgPo9Rlo.png 750w, https://miro.medium.com/v2/resize:fit:786/0*ud43sxuKpgPo9Rlo.png 786w, https://miro.medium.com/v2/resize:fit:828/0*ud43sxuKpgPo9Rlo.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*ud43sxuKpgPo9Rlo.png 1100w, https://miro.medium.com/v2/resize:fit:1114/0*ud43sxuKpgPo9Rlo.png 1114w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/557/0*ud43sxuKpgPo9Rlo.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">And conclude that,</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:70%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*sovSd27ja1_7R2yU.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*sovSd27ja1_7R2yU.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*sovSd27ja1_7R2yU.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*sovSd27ja1_7R2yU.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*sovSd27ja1_7R2yU.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*sovSd27ja1_7R2yU.png 1100w, https://miro.medium.com/v2/resize:fit:1046/format:webp/0*sovSd27ja1_7R2yU.png 1046w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px" srcset="https://miro.medium.com/v2/resize:fit:640/0*sovSd27ja1_7R2yU.png 640w, https://miro.medium.com/v2/resize:fit:720/0*sovSd27ja1_7R2yU.png 720w, https://miro.medium.com/v2/resize:fit:750/0*sovSd27ja1_7R2yU.png 750w, https://miro.medium.com/v2/resize:fit:786/0*sovSd27ja1_7R2yU.png 786w, https://miro.medium.com/v2/resize:fit:828/0*sovSd27ja1_7R2yU.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*sovSd27ja1_7R2yU.png 1100w, https://miro.medium.com/v2/resize:fit:1046/0*sovSd27ja1_7R2yU.png 1046w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/523/0*sovSd27ja1_7R2yU.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Now that we have <strong>∂E/∂W</strong> and <strong>∂E/∂B</strong>,<strong> </strong>we are left with <strong>∂E/∂X </strong>which is<strong> very important</strong> as it will “act” as ∂E/∂Y for the layer before that one.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:71%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*nPzn6Jgv-P0wxUA7.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*nPzn6Jgv-P0wxUA7.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*nPzn6Jgv-P0wxUA7.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*nPzn6Jgv-P0wxUA7.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*nPzn6Jgv-P0wxUA7.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*nPzn6Jgv-P0wxUA7.png 1100w, https://miro.medium.com/v2/resize:fit:1052/format:webp/0*nPzn6Jgv-P0wxUA7.png 1052w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" srcset="https://miro.medium.com/v2/resize:fit:640/0*nPzn6Jgv-P0wxUA7.png 640w, https://miro.medium.com/v2/resize:fit:720/0*nPzn6Jgv-P0wxUA7.png 720w, https://miro.medium.com/v2/resize:fit:750/0*nPzn6Jgv-P0wxUA7.png 750w, https://miro.medium.com/v2/resize:fit:786/0*nPzn6Jgv-P0wxUA7.png 786w, https://miro.medium.com/v2/resize:fit:828/0*nPzn6Jgv-P0wxUA7.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*nPzn6Jgv-P0wxUA7.png 1100w, https://miro.medium.com/v2/resize:fit:1052/0*nPzn6Jgv-P0wxUA7.png 1052w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/526/0*nPzn6Jgv-P0wxUA7.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Again, using the chain rule,</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:75%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 559px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*x6uE01GkG3NKLNQp.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*x6uE01GkG3NKLNQp.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*x6uE01GkG3NKLNQp.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*x6uE01GkG3NKLNQp.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*x6uE01GkG3NKLNQp.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*x6uE01GkG3NKLNQp.png 1100w, https://miro.medium.com/v2/resize:fit:1118/format:webp/0*x6uE01GkG3NKLNQp.png 1118w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 559px" srcset="https://miro.medium.com/v2/resize:fit:640/0*x6uE01GkG3NKLNQp.png 640w, https://miro.medium.com/v2/resize:fit:720/0*x6uE01GkG3NKLNQp.png 720w, https://miro.medium.com/v2/resize:fit:750/0*x6uE01GkG3NKLNQp.png 750w, https://miro.medium.com/v2/resize:fit:786/0*x6uE01GkG3NKLNQp.png 786w, https://miro.medium.com/v2/resize:fit:828/0*x6uE01GkG3NKLNQp.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*x6uE01GkG3NKLNQp.png 1100w, https://miro.medium.com/v2/resize:fit:1118/0*x6uE01GkG3NKLNQp.png 1118w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/559/0*x6uE01GkG3NKLNQp.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Finally, we can write the whole matrix :</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*JWCzIdtJVTeQ_PG8.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*JWCzIdtJVTeQ_PG8.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*JWCzIdtJVTeQ_PG8.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*JWCzIdtJVTeQ_PG8.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*JWCzIdtJVTeQ_PG8.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*JWCzIdtJVTeQ_PG8.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JWCzIdtJVTeQ_PG8.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*JWCzIdtJVTeQ_PG8.png 640w, https://miro.medium.com/v2/resize:fit:720/0*JWCzIdtJVTeQ_PG8.png 720w, https://miro.medium.com/v2/resize:fit:750/0*JWCzIdtJVTeQ_PG8.png 750w, https://miro.medium.com/v2/resize:fit:786/0*JWCzIdtJVTeQ_PG8.png 786w, https://miro.medium.com/v2/resize:fit:828/0*JWCzIdtJVTeQ_PG8.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*JWCzIdtJVTeQ_PG8.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*JWCzIdtJVTeQ_PG8.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*JWCzIdtJVTeQ_PG8.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">That’s it! We have the three formulas we needed for the FC layer!</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:31%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 246px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*HlI8qj8qZqGIWBrk.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*HlI8qj8qZqGIWBrk.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*HlI8qj8qZqGIWBrk.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*HlI8qj8qZqGIWBrk.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*HlI8qj8qZqGIWBrk.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*HlI8qj8qZqGIWBrk.png 1100w, https://miro.medium.com/v2/resize:fit:492/format:webp/0*HlI8qj8qZqGIWBrk.png 492w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 246px" srcset="https://miro.medium.com/v2/resize:fit:640/0*HlI8qj8qZqGIWBrk.png 640w, https://miro.medium.com/v2/resize:fit:720/0*HlI8qj8qZqGIWBrk.png 720w, https://miro.medium.com/v2/resize:fit:750/0*HlI8qj8qZqGIWBrk.png 750w, https://miro.medium.com/v2/resize:fit:786/0*HlI8qj8qZqGIWBrk.png 786w, https://miro.medium.com/v2/resize:fit:828/0*HlI8qj8qZqGIWBrk.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*HlI8qj8qZqGIWBrk.png 1100w, https://miro.medium.com/v2/resize:fit:492/0*HlI8qj8qZqGIWBrk.png 492w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/246/0*HlI8qj8qZqGIWBrk.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Coding the Fully Connected Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We can now write some python code to bring this math to life!</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>from layer import Layer
import numpy as np

# inherit from base class Layer
class FCLayer(Layer):
    # input_size = number of input neurons
    # output_size = number of output neurons
    def __init__(self, input_size, output_size):
        self.weights = np.random.rand(input_size, output_size) - 0.5
        self.bias = np.random.rand(1, output_size) - 0.5

    # returns output for a given input
    def forward_propagation(self, input_data):
        self.input = input_data
        self.output = np.dot(self.input, self.weights) + self.bias
        return self.output

    # computes dE/dW, dE/dB for a given output_error=dE/dY. Returns input_error=dE/dX.
    def backward_propagation(self, output_error, learning_rate):
        input_error = np.dot(output_error, self.weights.T)
        weights_error = np.dot(self.input.T, output_error)
        # dBias = output_error

        # update parameters
        self.weights -= learning_rate * weights_error
        self.bias -= learning_rate * output_error
        return input_error</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Activation Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">All the calculation we did until now were completely linear. It's hopeless to learn anything with that kind of model. We need to add <strong>non-linearity</strong> to the model by applying non-linear functions to the output of some layers.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Now we need to redo the whole process for this new type of layer!</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:80%;"><iframe  scrolling="auto" width="435.0" height="221.0" frameborder="0" src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2F26tPnXTr2f78OJrQ4%2Ftwitter%2Fiframe&url=https%3A%2F%2Fgiphy.com%2Fgifs%2F26tPnXTr2f78OJrQ4&image=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2F26tPnXTr2f78OJrQ4%2Fgiphy.gif&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=giphy" allowfullscreen=""></iframe></div><br><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://gph.is/21pKLjE" target="_self">https://gph.is/21pKLjE</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">No worries, it’s going to be way faster as there are no <em>learnable </em>parameters. We just need to calculate <strong>∂E/∂X</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We will call <code>f</code> and <code>f'</code> the activation function and its derivative respectively.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:51%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 385px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 1100w, https://miro.medium.com/v2/resize:fit:770/format:webp/1*xl7UacJfCUAk_KqX3WI49Q.png 770w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 385px" srcset="https://miro.medium.com/v2/resize:fit:640/1*xl7UacJfCUAk_KqX3WI49Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xl7UacJfCUAk_KqX3WI49Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xl7UacJfCUAk_KqX3WI49Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xl7UacJfCUAk_KqX3WI49Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xl7UacJfCUAk_KqX3WI49Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xl7UacJfCUAk_KqX3WI49Q.png 1100w, https://miro.medium.com/v2/resize:fit:770/1*xl7UacJfCUAk_KqX3WI49Q.png 770w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/385/1*xl7UacJfCUAk_KqX3WI49Q.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Forward Propagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">As you will see, it is quite straightforward. For a given input <code>X</code> , the output is simply the activation function applied to every element of <code>X</code> . Which means <strong>input</strong> and <strong>output</strong> have the<strong> same dimensions</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:60%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 453px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Aw9jCvpliMjaO00W.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*Aw9jCvpliMjaO00W.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*Aw9jCvpliMjaO00W.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*Aw9jCvpliMjaO00W.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*Aw9jCvpliMjaO00W.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Aw9jCvpliMjaO00W.png 1100w, https://miro.medium.com/v2/resize:fit:906/format:webp/0*Aw9jCvpliMjaO00W.png 906w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 453px" srcset="https://miro.medium.com/v2/resize:fit:640/0*Aw9jCvpliMjaO00W.png 640w, https://miro.medium.com/v2/resize:fit:720/0*Aw9jCvpliMjaO00W.png 720w, https://miro.medium.com/v2/resize:fit:750/0*Aw9jCvpliMjaO00W.png 750w, https://miro.medium.com/v2/resize:fit:786/0*Aw9jCvpliMjaO00W.png 786w, https://miro.medium.com/v2/resize:fit:828/0*Aw9jCvpliMjaO00W.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*Aw9jCvpliMjaO00W.png 1100w, https://miro.medium.com/v2/resize:fit:906/0*Aw9jCvpliMjaO00W.png 906w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/453/0*Aw9jCvpliMjaO00W.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Backward Propagation</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Given <strong>∂E/∂Y</strong>, we want to calculate <strong>∂E/∂X</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*9aXZPVNHXXpz1vd9.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*9aXZPVNHXXpz1vd9.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*9aXZPVNHXXpz1vd9.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*9aXZPVNHXXpz1vd9.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*9aXZPVNHXXpz1vd9.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*9aXZPVNHXXpz1vd9.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9aXZPVNHXXpz1vd9.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*9aXZPVNHXXpz1vd9.png 640w, https://miro.medium.com/v2/resize:fit:720/0*9aXZPVNHXXpz1vd9.png 720w, https://miro.medium.com/v2/resize:fit:750/0*9aXZPVNHXXpz1vd9.png 750w, https://miro.medium.com/v2/resize:fit:786/0*9aXZPVNHXXpz1vd9.png 786w, https://miro.medium.com/v2/resize:fit:828/0*9aXZPVNHXXpz1vd9.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*9aXZPVNHXXpz1vd9.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*9aXZPVNHXXpz1vd9.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*9aXZPVNHXXpz1vd9.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Be careful, here we are using an <strong>element-wise</strong> multiplication between the two matrices (whereas in the formulas above, it was a dot product).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Coding the Activation Layer</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The code for the activation layer is as straightforward.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>from layer import Layer

# inherit from base class Layer
class ActivationLayer(Layer):
    def __init__(self, activation, activation_prime):
        self.activation = activation
        self.activation_prime = activation_prime

    # returns the activated input
    def forward_propagation(self, input_data):
        self.input = input_data
        self.output = self.activation(self.input)
        return self.output

    # Returns input_error=dE/dX for a given output_error=dE/dY.
    # learning_rate is not used because there is no "learnable" parameters.
    def backward_propagation(self, output_error, learning_rate):
        return self.activation_prime(self.input) * output_error</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">You can also write some activation functions and their derivatives in a separate file. These will be used later to create an <code>ActivationLayer</code>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>import numpy as np

# activation function and its derivative
def tanh(x):
    return np.tanh(x);

def tanh_prime(x):
    return 1-np.tanh(x)**2;</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Loss Function</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Until now, for a given layer, we supposed that <strong>∂E/∂Y </strong>was<strong> </strong>given (by the next layer). But what happens to the last layer? How does it get <strong>∂E/∂Y</strong>? We simply give it manually, and it depends on how we define the error.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The error of the network, which measures how good or bad the network did for a given input data, is defined by <strong>you</strong>. There are many ways to define the error, and one of the most known is called <strong>MSE — Mean Squared Error</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:47%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 363px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*CuLKvZnTvjT1d6KJ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*CuLKvZnTvjT1d6KJ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*CuLKvZnTvjT1d6KJ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*CuLKvZnTvjT1d6KJ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*CuLKvZnTvjT1d6KJ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*CuLKvZnTvjT1d6KJ.png 1100w, https://miro.medium.com/v2/resize:fit:726/format:webp/0*CuLKvZnTvjT1d6KJ.png 726w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 363px" srcset="https://miro.medium.com/v2/resize:fit:640/0*CuLKvZnTvjT1d6KJ.png 640w, https://miro.medium.com/v2/resize:fit:720/0*CuLKvZnTvjT1d6KJ.png 720w, https://miro.medium.com/v2/resize:fit:750/0*CuLKvZnTvjT1d6KJ.png 750w, https://miro.medium.com/v2/resize:fit:786/0*CuLKvZnTvjT1d6KJ.png 786w, https://miro.medium.com/v2/resize:fit:828/0*CuLKvZnTvjT1d6KJ.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*CuLKvZnTvjT1d6KJ.png 1100w, https://miro.medium.com/v2/resize:fit:726/0*CuLKvZnTvjT1d6KJ.png 726w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/363/0*CuLKvZnTvjT1d6KJ.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Mean Squared Error</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Where <code>y*</code> and <code>y</code> denotes <strong>desired output</strong> and <strong>actual output</strong> respectively. You can think of the loss as a last layer which takes all the output neurons and squashes them into one single neuron. What we need now, as for every other layer, is to define <strong>∂E/∂Y</strong>. Except now, we finally reached <code>E</code> !</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:80%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 588px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*2ggVYLPNH-vIJir6.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*2ggVYLPNH-vIJir6.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*2ggVYLPNH-vIJir6.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*2ggVYLPNH-vIJir6.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*2ggVYLPNH-vIJir6.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*2ggVYLPNH-vIJir6.png 1100w, https://miro.medium.com/v2/resize:fit:1176/format:webp/0*2ggVYLPNH-vIJir6.png 1176w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 588px" srcset="https://miro.medium.com/v2/resize:fit:640/0*2ggVYLPNH-vIJir6.png 640w, https://miro.medium.com/v2/resize:fit:720/0*2ggVYLPNH-vIJir6.png 720w, https://miro.medium.com/v2/resize:fit:750/0*2ggVYLPNH-vIJir6.png 750w, https://miro.medium.com/v2/resize:fit:786/0*2ggVYLPNH-vIJir6.png 786w, https://miro.medium.com/v2/resize:fit:828/0*2ggVYLPNH-vIJir6.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*2ggVYLPNH-vIJir6.png 1100w, https://miro.medium.com/v2/resize:fit:1176/0*2ggVYLPNH-vIJir6.png 1176w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/588/0*2ggVYLPNH-vIJir6.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">These are simply two python functions that you can put in a separate file. They will be used when creating the network.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>import numpy as np

# loss function and its derivative
def mse(y_true, y_pred):
    return np.mean(np.power(y_true-y_pred, 2));

def mse_prime(y_true, y_pred):
    return 2*(y_pred-y_true)/y_true.size;</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Network Class</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Almost done ! We are going to make a <code>Network</code> class to create neural networks very easily akin the first picture !</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I commented almost every part of the code, it shouldn’t be too complicated to understand if you grasped the previous steps. Nevertheless, leave a comment if you have any question, I will gladly answer !</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>class Network:
    def __init__(self):
        self.layers = []
        self.loss = None
        self.loss_prime = None

    # add layer to network
    def add(self, layer):
        self.layers.append(layer)

    # set loss to use
    def use(self, loss, loss_prime):
        self.loss = loss
        self.loss_prime = loss_prime

    # predict output for given input
    def predict(self, input_data):
        # sample dimension first
        samples = len(input_data)
        result = []

        # run network over all samples
        for i in range(samples):
            # forward propagation
            output = input_data[i]
            for layer in self.layers:
                output = layer.forward_propagation(output)
            result.append(output)

        return result

    # train the network
    def fit(self, x_train, y_train, epochs, learning_rate):
        # sample dimension first
        samples = len(x_train)

        # training loop
        for i in range(epochs):
            err = 0
            for j in range(samples):
                # forward propagation
                output = x_train[j]
                for layer in self.layers:
                    output = layer.forward_propagation(output)

                # compute loss (for display purpose only)
                err += self.loss(y_train[j], output)

                # backward propagation
                error = self.loss_prime(y_train[j], output)
                for layer in reversed(self.layers):
                    error = layer.backward_propagation(error, learning_rate)

            # calculate average error on all samples
            err /= samples
            print('epoch %d/%d   error=%f' % (i+1, epochs, err))</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Building Neural Networks</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Finally ! We can use our class to create a neural network with as many layers as we want ! We are going to build two neural networks : a simple <strong>XOR</strong> and a <strong>MNIST</strong> solver.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Solve XOR</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Starting with XOR is always important as it’s a simple way to tell if the network is learning anything at all.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>import numpy as np

from network import Network
from fc_layer import FCLayer
from activation_layer import ActivationLayer
from activations import tanh, tanh_prime
from losses import mse, mse_prime

# training data
x_train = np.array([[[0,0]], [[0,1]], [[1,0]], [[1,1]]])
y_train = np.array([[[0]], [[1]], [[1]], [[0]]])

# network
net = Network()
net.add(FCLayer(2, 3))
net.add(ActivationLayer(tanh, tanh_prime))
net.add(FCLayer(3, 1))
net.add(ActivationLayer(tanh, tanh_prime))

# train
net.use(mse, mse_prime)
net.fit(x_train, y_train, epochs=1000, learning_rate=0.1)

# test
out = net.predict(x_train)
print(out)</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I don’t think I need to emphasize many things. Just be careful with the training data, you should always have the <strong>sample </strong>dimension <strong>first</strong>. For example here, the input shape is <strong>(4,1,2)</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Result</h4></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>$ python xor.py</strong> <br/>epoch 1/1000 error=0.322980<br/>epoch 2/1000 error=0.311174<br/>epoch 3/1000 error=0.307195<br/>...<br/>epoch 998/1000 error=0.000243<br/>epoch 999/1000 error=0.000242<br/>epoch 1000/1000 error=0.000242</span><span>[<br/>    array([[ 0.00077435]]),<br/>    array([[ 0.97760742]]),<br/>    array([[ 0.97847793]]),<br/>    array([[-0.00131305]])<br/>]</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Clearly this is working, great ! We can now solve something more interesting, let’s solve MNIST !</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Solve MNIST</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We didn’t implemented the Convolutional Layer but this is not a problem. All we need to do is to reshape our data so that it can fit into a Fully Connected Layer.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>MNIST Dataset consists of images of digits from 0 to 9, of shape 28x28x1. The goal is to predict what digit is drawn on a picture.</em></p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre>import numpy as np

from network import Network
from fc_layer import FCLayer
from activation_layer import ActivationLayer
from activations import tanh, tanh_prime
from losses import mse, mse_prime

from keras.datasets import mnist
from keras.utils import np_utils

# load MNIST from server
(x_train, y_train), (x_test, y_test) = mnist.load_data()

# training data : 60000 samples
# reshape and normalize input data
x_train = x_train.reshape(x_train.shape[0], 1, 28*28)
x_train = x_train.astype('float32')
x_train /= 255
# encode output which is a number in range [0,9] into a vector of size 10
# e.g. number 3 will become [0, 0, 0, 1, 0, 0, 0, 0, 0, 0]
y_train = np_utils.to_categorical(y_train)

# same for test data : 10000 samples
x_test = x_test.reshape(x_test.shape[0], 1, 28*28)
x_test = x_test.astype('float32')
x_test /= 255
y_test = np_utils.to_categorical(y_test)

# Network
net = Network()
net.add(FCLayer(28*28, 100))                # input_shape=(1, 28*28)    ;   output_shape=(1, 100)
net.add(ActivationLayer(tanh, tanh_prime))
net.add(FCLayer(100, 50))                   # input_shape=(1, 100)      ;   output_shape=(1, 50)
net.add(ActivationLayer(tanh, tanh_prime))
net.add(FCLayer(50, 10))                    # input_shape=(1, 50)       ;   output_shape=(1, 10)
net.add(ActivationLayer(tanh, tanh_prime))

# train on 1000 samples
# as we didn't implemented mini-batch GD, training will be pretty slow if we update at each iteration on 60000 samples...
net.use(mse, mse_prime)
net.fit(x_train[0:1000], y_train[0:1000], epochs=35, learning_rate=0.1)

# test on 3 samples
out = net.predict(x_test[0:3])
print("\n")
print("predicted values : ")
print(out, end="\n")
print("true values : ")
print(y_test[0:3])
</pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Result</h4></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>$</strong> <strong>python example_mnist_fc.py</strong><br/>epoch 1/30   error=0.238658<br/>epoch 2/30   error=0.093187<br/>epoch 3/30   error=0.073039<br/>...<br/>epoch 28/30   error=0.011636<br/>epoch 29/30   error=0.011306<br/>epoch 30/30   error=0.010901</span><span><strong>predicted values : </strong><br/>[<br/>    array([[ 0.119,  0.084 , -0.081,  0.084, -0.068, 0.011,  0.057,  <strong>0.976</strong>, -0.042, -0.0462]]),<br/>    array([[ 0.071,  0.211,  <strong>0.501</strong> ,  0.058, -0.020, 0.175,  0.057 ,  0.037,  0.020,  0.107]]),<br/>    array([[ 1.197e-01,  <strong>8.794e-01</strong>, -4.410e-04, 4.407e-02, -4.213e-02,  5.300e-02, 5.581e-02,  8.255e-02, -1.182e-01, 9.888e-02]])<br/>]<br/><strong>true values : </strong><br/>[[0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]<br/> [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]<br/> [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]]</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is working perfectly ! Amazing :)</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:80%;"><iframe  scrolling="auto" width="435.0" height="310.0" frameborder="0" src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fgiphy.com%2Fembed%2Fl3q2XhfQ8oCkm1Ts4%2Ftwitter%2Fiframe&display_name=Giphy&url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2Fl3q2XhfQ8oCkm1Ts4%2Fgiphy.gif&image=https%3A%2F%2Fi.giphy.com%2Fmedia%2Fl3q2XhfQ8oCkm1Ts4%2Fgiphy.gif&key=d04bfffea46d4aeda930ec88cc64b87c&type=text%2Fhtml&schema=giphy" allowfullscreen=""></iframe></div><br><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://gph.is/2jzemp3" target="_self">https://gph.is/2jzemp3</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">GitHub Repository & Google Colab</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">You can find the whole working code used for this post in the following GitHub repository, and Google Colab file. It also contains the code for other layers like <strong>Convolutional</strong> or <strong>Flatten</strong>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><div class="sketchy"><a href="https://github.com/OmarAflak/Medium-Python-Neural-Network"><h2 style="color:blueviolet; font-family:Arial, Helvetica, sans-serif; font-size:25px;">OmarAflak/Medium-Python-Neural-Network</h2><h3 style="color:rgb(45, 34, 54); font-family:Arial, Helvetica, sans-serif; font-size:20px;">Contribute to OmarAflak/Medium-Python-Neural-Network development by creating an account on GitHub.</h3><p>github.com</p></a></div></div></div></div></section><br><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><div class="sketchy"><a href="https://colab.research.google.com/drive/10y6glU28-sa-OtkeL8BtAtRlOITGMnMw"><h2 style="color:blueviolet; font-family:Arial, Helvetica, sans-serif; font-size:25px;">Neural Networks from Scratch in Python</h2><h3 style="color:rgb(45, 34, 54); font-family:Arial, Helvetica, sans-serif; font-size:20px;">Feel free to contact me</h3><p>colab.research.google.com</p></a></div></div></div></div></section><br><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I’ve recently put the content of that article into a beautifully animated video. You can check it out on YouTube.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:80%;"><iframe  scrolling="auto" width="854.0" height="480.0" frameborder="0" src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FpauPCy_s0Ok%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DpauPCy_s0Ok&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FpauPCy_s0Ok%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube" allowfullscreen=""></iframe></div><br><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Neural Network from Scratch | Mathematics & Python Code — The Independent Code</p><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:80%;"><iframe  scrolling="auto" width="854.0" height="480.0" frameborder="0" src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FLakz2MoHy6o&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DLakz2MoHy6o&image=http%3A%2F%2Fi.ytimg.com%2Fvi%2FLakz2MoHy6o%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube" allowfullscreen=""></iframe></div><br><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Convolutional Neural Network from Scratch | Mathematics & Python Code — The Independent Code</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5"><strong>If you liked this post — I’d really appreciate if you hit the clap button </strong>👏<strong> it would help me a lot. Peace! 😎</strong></h4></div></div></div></section><?php include_once 'Elemental/footer.php'; ?>