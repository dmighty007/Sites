<!DOCTYPE html>
                <html>
                <head>
                    <title>Multivariate Time Series using RNN with Keras</title>
                <?php include_once 'Elemental/header.php'; ?><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><br><br><h5> This article is reformatted from originally published at <a href="https://medium.datadriveninvestor.com/multivariate-time-series-using-rnn-with-keras-7f78f4488679"><strong>TDS(Towards Data Science)</strong></a></h5></br><h5> <a href="https://arshren.medium.com/?source=post_page-----7f78f4488679--------------------------------">Author : Renu Khandelwal</a> </h5></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*McssR8tiwSC0bQW8 640w, https://miro.medium.com/v2/resize:fit:720/0*McssR8tiwSC0bQW8 720w, https://miro.medium.com/v2/resize:fit:750/0*McssR8tiwSC0bQW8 750w, https://miro.medium.com/v2/resize:fit:786/0*McssR8tiwSC0bQW8 786w, https://miro.medium.com/v2/resize:fit:828/0*McssR8tiwSC0bQW8 828w, https://miro.medium.com/v2/resize:fit:1100/0*McssR8tiwSC0bQW8 1100w, https://miro.medium.com/v2/resize:fit:1400/0*McssR8tiwSC0bQW8 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/0*McssR8tiwSC0bQW8 640w, https://miro.medium.com/v2/resize:fit:720/0*McssR8tiwSC0bQW8 720w, https://miro.medium.com/v2/resize:fit:750/0*McssR8tiwSC0bQW8 750w, https://miro.medium.com/v2/resize:fit:786/0*McssR8tiwSC0bQW8 786w, https://miro.medium.com/v2/resize:fit:828/0*McssR8tiwSC0bQW8 828w, https://miro.medium.com/v2/resize:fit:1100/0*McssR8tiwSC0bQW8 1100w, https://miro.medium.com/v2/resize:fit:1400/0*McssR8tiwSC0bQW8 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/0*McssR8tiwSC0bQW8"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content4 cid-tt5SM2WLsM" id="content4-2" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="title col-md-12 col-lg-9">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                            <strong>Multivariate Time Series using RNN with Keras</h3></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>In this post, we will do Google stock prediction using time series. We will use Keras and Recurrent Neural Network(RNN).</em></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Prerequisites :</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><a href="https://medium.com/datadriveninvestor/recurrent-neural-network-rnn-52dd4f01b7e8" target="_self">Recurrent Neural Network</a></p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8ZykMhn6hucROBH8H18eng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8ZykMhn6hucROBH8H18eng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8ZykMhn6hucROBH8H18eng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8ZykMhn6hucROBH8H18eng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8ZykMhn6hucROBH8H18eng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8ZykMhn6hucROBH8H18eng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZykMhn6hucROBH8H18eng.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*8ZykMhn6hucROBH8H18eng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8ZykMhn6hucROBH8H18eng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8ZykMhn6hucROBH8H18eng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8ZykMhn6hucROBH8H18eng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8ZykMhn6hucROBH8H18eng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8ZykMhn6hucROBH8H18eng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8ZykMhn6hucROBH8H18eng.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*8ZykMhn6hucROBH8H18eng.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I have downloaded the Google stock prices for past 5 years from <a href="https://www.nasdaq.com/symbol/goog/historical" target="_self">https://www.nasdaq.com/symbol/goog/historical</a> to a csv file Google2014to2019.csv</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">First importing the basic libraries and reading the data from the CSV file</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span><mark>stock_data</mark> = pd.read_csv("D:\\Machine Learning\\Google2014to2019.csv")</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Letâ€™s print 2 rows of the data in the dataset</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>stock_data.head(2)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdjeEZ74JV14b-mW57lzQQ.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*zdjeEZ74JV14b-mW57lzQQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zdjeEZ74JV14b-mW57lzQQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zdjeEZ74JV14b-mW57lzQQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zdjeEZ74JV14b-mW57lzQQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zdjeEZ74JV14b-mW57lzQQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zdjeEZ74JV14b-mW57lzQQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zdjeEZ74JV14b-mW57lzQQ.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*zdjeEZ74JV14b-mW57lzQQ.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">stock_data.head(2)</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Also printing the information about the dataset</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>stock_data.info()</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:38%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 297px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 1100w, https://miro.medium.com/v2/resize:fit:594/format:webp/1*4L_r_WChhkRy3VRFualuhQ.png 594w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 297px" srcset="https://miro.medium.com/v2/resize:fit:640/1*4L_r_WChhkRy3VRFualuhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4L_r_WChhkRy3VRFualuhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4L_r_WChhkRy3VRFualuhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4L_r_WChhkRy3VRFualuhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4L_r_WChhkRy3VRFualuhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4L_r_WChhkRy3VRFualuhQ.png 1100w, https://miro.medium.com/v2/resize:fit:594/1*4L_r_WChhkRy3VRFualuhQ.png 594w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/297/1*4L_r_WChhkRy3VRFualuhQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We will take the average of the low and high of the Google stock for the day and volume of the stocks traded for the day to predict the stock prices.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>import math</span><span>stock_data["average"] = (stock_data["high"] + stock_data["low"])/2</span><span>stock_data.head(2)<br/></span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQOmYyYNWV0-Ao59jtrSbQ.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*oQOmYyYNWV0-Ao59jtrSbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oQOmYyYNWV0-Ao59jtrSbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oQOmYyYNWV0-Ao59jtrSbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oQOmYyYNWV0-Ao59jtrSbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oQOmYyYNWV0-Ao59jtrSbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oQOmYyYNWV0-Ao59jtrSbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*oQOmYyYNWV0-Ao59jtrSbQ.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*oQOmYyYNWV0-Ao59jtrSbQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Letâ€™s take the volume and average stock price as our input features and store it in input_data</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>input_feature= stock_data.iloc[:,[2,6]].values<br/>input_data = input_feature</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We will plot the data for volume for the Google stocks traded for the day</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>plt.plot(input_feature[:,0])<br/>plt.title("Volume of stocks sold")<br/>plt.xlabel("Time (latest-&gt; oldest)")<br/>plt.ylabel("Volume of stocks traded")<br/>plt.show()</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:67%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 1100w, https://miro.medium.com/v2/resize:fit:1002/format:webp/1*9AnDN7qyJXWOxULhu6mTjg.png 1002w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 501px" srcset="https://miro.medium.com/v2/resize:fit:640/1*9AnDN7qyJXWOxULhu6mTjg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9AnDN7qyJXWOxULhu6mTjg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9AnDN7qyJXWOxULhu6mTjg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9AnDN7qyJXWOxULhu6mTjg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9AnDN7qyJXWOxULhu6mTjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9AnDN7qyJXWOxULhu6mTjg.png 1100w, https://miro.medium.com/v2/resize:fit:1002/1*9AnDN7qyJXWOxULhu6mTjg.png 1002w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/501/1*9AnDN7qyJXWOxULhu6mTjg.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Volume of Google stocks traded</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We now plot the data for the average price for the day the Google stock</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>plt.plot(input_feature[:,1], color='blue')<br/>plt.title("Google Stock Prices")<br/>plt.xlabel("Time (latest-&gt; oldest)")<br/>plt.ylabel("Stock Opening Price")<br/>plt.show()</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:71%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 528px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 1100w, https://miro.medium.com/v2/resize:fit:1056/format:webp/1*3I-hODqpbqpEbJ5b1FcKYQ.png 1056w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 528px" srcset="https://miro.medium.com/v2/resize:fit:640/1*3I-hODqpbqpEbJ5b1FcKYQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3I-hODqpbqpEbJ5b1FcKYQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3I-hODqpbqpEbJ5b1FcKYQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3I-hODqpbqpEbJ5b1FcKYQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3I-hODqpbqpEbJ5b1FcKYQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3I-hODqpbqpEbJ5b1FcKYQ.png 1100w, https://miro.medium.com/v2/resize:fit:1056/1*3I-hODqpbqpEbJ5b1FcKYQ.png 1056w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/528/1*3I-hODqpbqpEbJ5b1FcKYQ.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Average Google stock price</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Normalizing the input data using MinMaxScaler so that all the input features are on the scale from 0 to 1</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>from sklearn.preprocessing import MinMaxScaler</span><span>sc= MinMaxScaler(feature_range=(0,1))<br/>input_data[:,0:2] = sc.fit_transform(input_feature[:,:])<br/></span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This is a time series problem. If we need to predict the Google stock prices correctly then we need to consider the volume of the stocks traded from the previous days as well as the average stock prices from previous days.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>We will be creating the data that will go back to 50 business days in past for the prediction.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Also, we will take 30 % of the latest data as our test dataset.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For RNN LSTM to predict the data we need to convert the input data.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Input data is in the form: [<em>Volume of stocks traded, Average stock price</em>] and we need to create a time series data.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The time series data for today should contain the [<em>Volume of stocks traded, Average stock price</em>] for past 50 days and the target variable will be Googleâ€™s stock price today and so on.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>As the stock price prediction is based on multiple input features, it is a multivariate regression problem.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We loop through all the samples and for each day we go back 50 business days in the past and add the volume of the stocks traded an average stock price.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>lookback= 50</strong><br/><br/>test_size=int(.3 * len(stock_data))<br/>X=[]<br/>y=[]<br/>for i in range(len(stock_data)-lookback-1):<br/>    t=[]<br/>    for j in range(0,lookback):<br/>        <br/>        <strong>t.append(input_data[[(i+j)], :])<br/>    X.append(t)<br/>    y.append(input_data[i+ lookback,1])</strong></span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>LSTM expects the input data in a specific 3D format of test sample size, time steps, no. of input features.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">In our case timesteps is 50, number of input features is 2(volume of stocks traded and the average stock price).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>We can transform the input data into LSTMâ€™s expected structure using numpy.reshape(). We need to first convert input data X into an array and then use the reshape()</strong></p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>X, y= np.array(X), np.array(y)</strong><br/>X_test = X[:test_size+lookback]</span><span><strong>X = X.reshape(X.shape[0],lookback, 2)<br/>X_test = X_test.reshape(X_test.shape[0],lookback, 2)</strong><br/>print(X.shape)<br/>print(X_test.shape)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:36%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 283px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 1100w, https://miro.medium.com/v2/resize:fit:566/format:webp/1*6KhF7HZso_OMU_OVMv8rig.png 566w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 283px" srcset="https://miro.medium.com/v2/resize:fit:640/1*6KhF7HZso_OMU_OVMv8rig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6KhF7HZso_OMU_OVMv8rig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6KhF7HZso_OMU_OVMv8rig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6KhF7HZso_OMU_OVMv8rig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6KhF7HZso_OMU_OVMv8rig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6KhF7HZso_OMU_OVMv8rig.png 1100w, https://miro.medium.com/v2/resize:fit:566/1*6KhF7HZso_OMU_OVMv8rig.png 566w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/283/1*6KhF7HZso_OMU_OVMv8rig.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Dimension of the training data and test data- No. of sample, time steps and no. of input features</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Our data is now ready and we can build the RNN LSTM model and fit the data.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Importing the required keras libraries to build the LSTM network</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>from keras import Sequential<br/>from keras.layers import Dense, LSTM</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We add 30 RNN cells that will be stacked one after the other in the RNN, implementing an efficient stacked RNN.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>return_sequences</strong>is True to return the last output in the output sequence.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>input_shape will be of the 3D format of test sample size, time steps, no. of input features.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Finally, the output will have only one unit as this is a regression problem</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>model = Sequential()<br/>model.add(LSTM(units=30, return_sequences= True, input_shape=(X.shape[1],2)))<br/>model.add(LSTM(units=30, return_sequences=True))<br/>model.add(LSTM(units=30))<br/>model.add(Dense(units=1))</span><span>model.summary()</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuIAz9L0bg_DbUl48UAJ-A.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*vuIAz9L0bg_DbUl48UAJ-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vuIAz9L0bg_DbUl48UAJ-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vuIAz9L0bg_DbUl48UAJ-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vuIAz9L0bg_DbUl48UAJ-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vuIAz9L0bg_DbUl48UAJ-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vuIAz9L0bg_DbUl48UAJ-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*vuIAz9L0bg_DbUl48UAJ-A.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*vuIAz9L0bg_DbUl48UAJ-A.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">LSTM model summary</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>We now compile the model using adam optimizer and loss function will be mean squared error for the regression problem</strong></p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>model.compile(optimizer='adam', loss='mean_squared_error')</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We now fit the data to the input data using batch_size of 32 and 100 epochs</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>model.fit(X, y, epochs=200, batch_size=32)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W35B5zbDsOkXRUv3Ey6IPQ.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*W35B5zbDsOkXRUv3Ey6IPQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*W35B5zbDsOkXRUv3Ey6IPQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*W35B5zbDsOkXRUv3Ey6IPQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*W35B5zbDsOkXRUv3Ey6IPQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*W35B5zbDsOkXRUv3Ey6IPQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*W35B5zbDsOkXRUv3Ey6IPQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*W35B5zbDsOkXRUv3Ey6IPQ.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*W35B5zbDsOkXRUv3Ey6IPQ.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We finally predict the stock prices of the test data</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>predicted_value= model.predict(X_test)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I am not doing an inverse scalar function. I am directly plotting the scaled stock prices and scaled predicted prices.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For plotting actual stock prices against the predicted stock prices, we need to start from lookback rows till the size of the test data</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>plt.plot(predicted_value, color= 'red')</strong></span><span><strong>plt.plot(input_data[lookback:test_size+(2*lookback),1], color='green')</strong></span><span>plt.title("Opening price of stocks sold")<br/>plt.xlabel("Time (latest-&gt; oldest)")<br/>plt.ylabel("Stock Opening Price")<br/>plt.show()</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:94%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 686px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 1100w, https://miro.medium.com/v2/resize:fit:1372/format:webp/1*6-ULlhGU1kMYDjtSKdYc-A.png 1372w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 686px" srcset="https://miro.medium.com/v2/resize:fit:640/1*6-ULlhGU1kMYDjtSKdYc-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6-ULlhGU1kMYDjtSKdYc-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6-ULlhGU1kMYDjtSKdYc-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6-ULlhGU1kMYDjtSKdYc-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6-ULlhGU1kMYDjtSKdYc-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6-ULlhGU1kMYDjtSKdYc-A.png 1100w, https://miro.medium.com/v2/resize:fit:1372/1*6-ULlhGU1kMYDjtSKdYc-A.png 1372w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/686/1*6-ULlhGU1kMYDjtSKdYc-A.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;">Actual and predicted Google stock prices</p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Predicted price is in red color and actual stock prices are in green color.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We see that we have done a decent job with stock prediction using LSTM with multiple input features</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><a href="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fupscri.be%2Fb2a0d6%3Fas_embed%3Dtrue&dntp=1&display_name=Upscribe&url=https%3A%2F%2Fupscri.be%2Fb2a0d6%2F&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=upscri">Click Here!</a></p></div></div></div></section><br></div></div></div></div></section><?php include_once 'Elemental/footer.php'; ?>