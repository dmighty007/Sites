<!DOCTYPE html>
                <html>
                <head>
                    <title>Building a Simple Chatbot from Scratch in Python (using NLTK)</title>
                <?php include_once 'Elemental/header.php'; ?><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><br><br><h5> This article is reformatted from originally published at <a href="https://medium.com/analytics-vidhya/building-a-simple-chatbot-in-python-using-nltk-7c8c8215ac6e"><strong>TDS(Towards Data Science)</strong></a></h5></br><h5> <a href="https://medium.com/@pandeyparul?source=post_page-----7c8c8215ac6e--------------------------------">Author : Parul Pandey</a> </h5></div></div></div></section><section data-bs-version="5.1" class="content4 cid-tt5SM2WLsM" id="content4-2" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="title col-md-12 col-lg-9">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2">
                            <strong>Building a Simple Chatbot from Scratch in Python (using NLTK)</h3></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1REh38g3mexmSZtoMRh2w.jpeg 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*-1REh38g3mexmSZtoMRh2w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*-1REh38g3mexmSZtoMRh2w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*-1REh38g3mexmSZtoMRh2w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*-1REh38g3mexmSZtoMRh2w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*-1REh38g3mexmSZtoMRh2w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*-1REh38g3mexmSZtoMRh2w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-1REh38g3mexmSZtoMRh2w.jpeg 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*-1REh38g3mexmSZtoMRh2w.jpeg"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">I am sure you‚Äôve heard about <a href="https://www.duolingo.com/" target="_self">Duolingo</a>: a popular language-learning app, which gamifies practicing a new language. It is pretty popular due to its innovative styles of teaching a foreign language. The concept is simple: five to ten minutes of interactive training a day is enough to learn a language.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">However, even though Duolingo enables people to learn a new language, its practitioners had a concern. People felt they were missing out on learning valuable conversational skills since they were learning on their own. People were also apprehensive about being paired with other language learners due to fear of embarrassment. This was turning out to be a <a href="https://www.theguardian.com/technology/2016/oct/06/duolingo-chatbots-learning-language" target="_self">significant bottleneck in Duolingo‚Äôs plans</a>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">So their team solved this problem by building a native chatbot within its app to help users learn conversational skills and practice what they learned.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:40%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 313px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 1100w, https://miro.medium.com/v2/resize:fit:626/format:webp/1*Rtjdt3incn3l8Rba5mip9A.png 626w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 313px" srcset="https://miro.medium.com/v2/resize:fit:640/1*Rtjdt3incn3l8Rba5mip9A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Rtjdt3incn3l8Rba5mip9A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Rtjdt3incn3l8Rba5mip9A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Rtjdt3incn3l8Rba5mip9A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Rtjdt3incn3l8Rba5mip9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Rtjdt3incn3l8Rba5mip9A.png 1100w, https://miro.medium.com/v2/resize:fit:626/1*Rtjdt3incn3l8Rba5mip9A.png 626w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/313/1*Rtjdt3incn3l8Rba5mip9A.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="http://bots.duolingo.com/" target="_self">http://bots.duolingo.com/</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Since the bots are designed as conversational and friendly, Duolingo learners can practice conversation any time of the day, using their choice of characters, until they feel brave enough to practice their new language with other speakers. <strong>This solved a major consumer pain point and made learning through the app a lot more fun.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">So what is a chatbot?</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">A <strong>chatbot</strong> is an artificial intelligence-powered piece of software in a device (Siri, Alexa, Google Assistant, etc.), application, website, or other networks. It gauges consumer‚Äôs needs and then assists them in performing a particular task like a commercial transaction, hotel booking, form submission, etc. Today almost every company has a chatbot deployed to engage with the users. Some of the ways in which companies are using chatbots are:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">To deliver flight information</li><li class="ff3" style="font-size:22px;">to connect customers and their finances</li><li class="ff3" style="font-size:22px;">As customer support</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The possibilities are (almost) limitless.</p></div></div></div></section><section data-bs-version="5.1" class="content7 cid-ttbhFZC4Ql" id="content7-8" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
        <div class="container"><div class="row justify-content-center"><div class="col-12 col-md-9"><blockquote><p class="ff4"><strong>History of chatbots dates back to 1966 when a computer program called ELIZA was invented by Weizenbaum. It imitated the language of a psychotherapist from only 200 lines of code. You can still converse with it here: </strong><a href="http://psych.fullerton.edu/mbirnbaum/psych101/Eliza.htm?utm_source=ubisend.com&utm_medium=blog-link&utm_campaign=ubisend" target="_self">Eliza</a><strong>.</strong></p></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jbbj376HkLMqqnIRAhsjKg.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*Jbbj376HkLMqqnIRAhsjKg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Jbbj376HkLMqqnIRAhsjKg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Jbbj376HkLMqqnIRAhsjKg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Jbbj376HkLMqqnIRAhsjKg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Jbbj376HkLMqqnIRAhsjKg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Jbbj376HkLMqqnIRAhsjKg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Jbbj376HkLMqqnIRAhsjKg.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*Jbbj376HkLMqqnIRAhsjKg.png"></picture></div><p class="mbr-description mbr-fonts-style mt-2 align-center display-12 text-muted" style="font-size:12px;"><a href="https://www.cognizant.com/Resources/the-chatbot-imperative-intelligence-personalization-and-utilitarian-design-codex2469.pdf" target="_self">S</a>ource: <a href="https://www.cognizant.com/Resources/the-chatbot-imperative-intelligence-personalization-and-utilitarian-design-codex2469.pdf" target="_self">Cognizant</a></p><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">How do Chatbots work?</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">There are broadly two variants of <a href="https://medium.com/botsupply/rule-based-bots-vs-ai-bots-b60cdb786ffa" target="_self">chatbots</a>: <strong>Rule-Based </strong>and<strong> Self-learning.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ol><li class="ff3" style="font-size:22px;">In a<strong> Rule-based approach</strong>, a bot answers questions based on some rules, which it is trained on. The rules defined can be very simple to very complex. The bots can handle simple queries but fail to manage complex ones.</li><li class="ff3" style="font-size:22px;">Self-learning bots are the ones that use some Machine Learning-based approaches and are more efficient than rule-based bots. These bots can be of further two types: <strong>Retrieval Based </strong>or <strong>Generative.</strong></li></ol></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">i) In <strong>retrieval-based models</strong>, a chatbot uses some <mark>heuristic to select a response from a library of predefined responses</mark>. The chatbot uses the message and context of the conversation for choosing the best response from a predefined list of bot messages. The context can include a current position in the dialogue tree, all previous messages in the conversation, previously saved variables (e.g., username). Heuristics for selecting a response can be engineered in many different ways, from rule-based if-else conditional logic to machine learning classifiers.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">ii) <strong>Generative </strong>bots can generate the answers and not always replies with one of the answers from a set of answers. This makes them more intelligent as they take word by word from the query and generates the answers.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4SzjHTccgX85iRrw589Y1g.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*4SzjHTccgX85iRrw589Y1g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4SzjHTccgX85iRrw589Y1g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4SzjHTccgX85iRrw589Y1g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4SzjHTccgX85iRrw589Y1g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4SzjHTccgX85iRrw589Y1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4SzjHTccgX85iRrw589Y1g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4SzjHTccgX85iRrw589Y1g.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*4SzjHTccgX85iRrw589Y1g.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content7 cid-ttbhFZC4Ql" id="content7-8" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
        <div class="container"><div class="row justify-content-center"><div class="col-12 col-md-9"><blockquote><p class="ff4">In this article we will build a simple retrieval based chatbot based on NLTK library in python.</p></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-5">Building the Bot</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Pre-requisites</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Hands-On knowledge of <strong>scikit</strong> library and <strong>NLTK</strong> is assumed. However, if you are new to NLP, you can still read the article and then refer back to resources.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">NLP</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The field of study that focuses on the interactions between human language and computers is called Natural Language Processing, or NLP for short. It sits at the intersection of computer science, artificial intelligence, and computational linguistics[Wikipedia].NLP is a way for computers to analyze, understand, and derive meaning from human language in a smart and useful way. By utilizing NLP, developers can organize and structure knowledge to perform tasks such as automatic summarization, translation, named entity recognition, relationship extraction, sentiment analysis, speech recognition, and topic segmentation.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">NLTK: A Brief Intro</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>NLTK(Natural Language Toolkit)</strong> is a leading platform for building Python programs to work with human language data. It provides easy-to-use interfaces to <a href="http://nltk.org/nltk_data/" target="_self">over 50 corpora and lexical resources</a> such as WordNet, along with a suite of text processing libraries for classification, tokenization, stemming, tagging, parsing, and semantic reasoning, wrappers for industrial-strength NLP libraries.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">NLTK has been called ‚Äúa wonderful tool for teaching and working in computational linguistics using Python‚Äù and ‚Äúan amazing library to play with natural language.‚Äù</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><a href="http://nltk.org/book" target="_self">Natural Language Processing with Python</a> provides a practical introduction to programming for language processing. I highly recommend this book to people beginning in NLP with Python.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Downloading and installing NLTK</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ol><li class="ff3" style="font-size:22px;">Install NLTK: run <code>pip install nltk</code></li><li class="ff3" style="font-size:22px;">Test installation: run <code>python</code> then type <code>import nltk</code></li></ol></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For platform-specific instructions, read <a href="https://www.nltk.org/install.html" target="_self">here</a>.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Installing NLTK Packages</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">import NLTK and run <code>nltk.download().</code>This will open the NLTK downloader from where you can choose the corpora and models to download. You can also download all packages at once.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Text Pre- Processing with NLTK</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The main issue with text data is that it is all in text format (strings). However, Machine learning algorithms need some sort of numerical feature vector to perform the task. So before we start with any NLP project, we need to pre-process it to make it ideal for work. Basic <strong>text pre-processing</strong> includes:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">Converting the entire text into <strong>uppercase or lowercase</strong> so that the algorithm does not treat the same words in different cases as different</li><li class="ff3" style="font-size:22px;"><strong>Tokenization</strong>: Tokenization is just the term used to describe the process of converting the normal text strings into a list of tokens, i.e., words that we want. A sentence tokenizer can be used to find the list of sentences, and a Word tokenizer can be used to find the list of words in strings.</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>The NLTK data package includes a pre-trained Punkt tokenizer for English.</em></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">Removing <strong>Noise,</strong> i.e., everything that isn‚Äôt in a standard number or letter.</li><li class="ff3" style="font-size:22px;">Removing <strong>Stop words. </strong>Sometimes, some extremely common words that appear to be of little value in helping select documents matching a user need are excluded from the vocabulary entirely. These words are called <em>stop words.</em></li><li class="ff3" style="font-size:22px;"><strong>Stemming</strong>: Stemming is the process of reducing inflected (or sometimes derived) words to their stem, base, or root form ‚Äî generally a written word form. For example, if we were to stem the following words: ‚ÄúStems,‚Äù ‚ÄúStemming,‚Äù ‚ÄúStemmed,‚Äù ‚Äúand Stemtization,‚Äù the result would be a single word, ‚Äústem.‚Äù</li><li class="ff3" style="font-size:22px;"><strong>Lemmatization</strong>: A slight variant of stemming is lemmatization. The major difference between these is that stemming can often create non-existent words, whereas lemmas are actual words. So, your root stem, meaning the word you end up with, is not something you can look up in a dictionary, but you can look up a lemma. Examples of Lemmatization are that ‚Äúrun‚Äù is a base form for words like ‚Äúrunning‚Äù or ‚Äúran‚Äù or that the word ‚Äúbetter‚Äù and ‚Äúgood‚Äù are in the same lemma, so they are considered the same.</li></ul></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Bag of Words</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">After the initial preprocessing phase, we need to transform the text into a meaningful vector (or array) of numbers. The bag-of-words is a representation of text that describes the occurrence of words within a document. It involves two things:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">‚Ä¢A vocabulary of known words.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">‚Ä¢A measure of the presence of known words.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Why is it called a ‚Äú<em>bag</em>‚Äù of words? That is because any information about the order or structure of words in the document is discarded, and the model is only concerned with <strong>whether the known words occur in the document, not where they occur in the document.</strong></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">The intuition behind the Bag of Words is that documents are similar if they have identical content. Also, we can learn something about the meaning of the document from its content alone.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For example, if our dictionary contains the words {Learning, is, the, not, great}, and we want to vectorize the text ‚ÄúLearning is great,‚Äù we would have the following vector: (1, 1, 0, 0, 1).</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">TF-IDF Approach</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">A problem with the Bag of Words approach is that highly frequent words start to dominate in the document (e.g., larger score) but may not contain as much ‚Äúinformational content.‚Äù Also, it will give more weight to longer documents than shorter documents.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">One approach is to rescale the frequency of words by how often they appear in all documents so that the scores for frequent words like ‚Äúthe‚Äù that are also frequent across all documents are penalized. This approach to scoring is called <strong>Term Frequency-Inverse Document Frequency</strong>, or <strong>TF-IDF</strong> for short, where:</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Term Frequency</strong>: is a scoring of the frequency of the word in the current document.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>TF = (Number of times term t appears in a document)/(Number of terms in the document)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Inverse Document Frequency</strong>: is a scoring of how rare the word is across documents.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>IDF = 1+log(N/n), where, N is the number of documents and n is the number of documents a term t has appeared in.</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Tf-IDF weight is a weight often used in information retrieval and text mining. This weight is a statistical measure used to evaluate how important a word is to a document in a collection or corpus.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Example:</strong></p></div></div></div></section><section data-bs-version="5.1" class="content7 cid-ttbhFZC4Ql" id="content7-8" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
        <div class="container"><div class="row justify-content-center"><div class="col-12 col-md-9"><blockquote><p class="ff4">Consider a document containing 100 words wherein the word ‚Äòphone‚Äô appears 5 times.The term frequency (i.e., tf) for phone is then (5 / 100) = 0.05. Now, assume we have 10 million documents and the word phone appears in one thousand of these. Then, the inverse document frequency (i.e., IDF) is calculated as log(10,000,000 / 1,000) = 4. Thus, the Tf-IDF weight is the product of these quantities: 0.05 * 4 = 0.20.Tf-IDF can be implemented in scikit learn as:from sklearn.feature_extraction.text import TfidfVectorizer</p></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Cosine Similarity</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">TF-IDF is a transformation applied to texts to get two real-valued vectors in vector space. We can then obtain the <strong>Cosine </strong>similarity of any pair of vectors by taking their dot product and dividing that by the product of their norms. That yields the cosine of the angle between the vectors. <strong>Cosine similarity</strong> is a <a href="https://en.wikipedia.org/wiki/Measure_of_similarity" target="_self">measure of similarity</a> between two non-zero vectors. Using this formula, we can find out the similarity between any two documents d1 and d2.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>Cosine Similarity (d1, d2) =  Dot product(d1, d2) / ||d1|| * ||d2||</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Where d1,d2 are two non-zero vectors.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>For a detailed explanation and practical example of TF-IDF and Cosine Similarity, refer to the document below.</em></p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><div class="sketchy"><a href="https://janav.wordpress.com/2013/10/27/tf-idf-and-cosine-similarity/"><h2 style="color:blueviolet; font-family:Arial, Helvetica, sans-serif; font-size:25px;">Tf-Idf and Cosine similarity</h2><h3 style="color:rgb(45, 34, 54); font-family:Arial, Helvetica, sans-serif; font-size:20px;">In the year 1998, Google handled 9800 average search queries every day. In 2012 this number shot up to 5.13 billion‚Ä¶</h3><p>janav.wordpress.com</p></a></div></div></div></div></section><br><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
            <br>
                <hr class="hr5">
            <br>
            </div>
        </div>
    </div>
</section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><strong>Now we have a fair idea of the NLP process. It is time that we get to our real task, i.e, Chatbot creation. We will name the chatbot here as ‚ÄòROBO</strong>ü§ñ<strong>.‚Äô</strong></p></div></div></div></section><section data-bs-version="5.1" class="content7 cid-ttbhFZC4Ql" id="content7-8" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
        <div class="container"><div class="row justify-content-center"><div class="col-12 col-md-9"><blockquote><p class="ff4"><em>You can </em>find the entire code with the corpus at the associated Github Repository <a href="https://github.com/parulnith/Building-a-Simple-Chatbot-in-Python-using-NLTK/blob/master/chatbot.py" target="_self">here</a> or you can view it on my binder by clicking the image below.</p></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0N8xD52e3kvyetrDNY7lg.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*G0N8xD52e3kvyetrDNY7lg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*G0N8xD52e3kvyetrDNY7lg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*G0N8xD52e3kvyetrDNY7lg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*G0N8xD52e3kvyetrDNY7lg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*G0N8xD52e3kvyetrDNY7lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*G0N8xD52e3kvyetrDNY7lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*G0N8xD52e3kvyetrDNY7lg.png 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*G0N8xD52e3kvyetrDNY7lg.png"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Importing the necessary libraries</h4></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>import nltk<br/>import numpy as np<br/>import random<br/>import string # to process standard python strings</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Corpus</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">For our example, we will be using the Wikipedia page for <a href="https://en.wikipedia.org/wiki/Chatbot" target="_self">chatbots</a> as our corpus. Copy the contents from the page and place them in a text file named ‚Äòchatbot.txt.‚Äô However, you can use any corpus of your choice.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Reading in the data</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We will read in the corpus.txt file and convert the entire corpus into a list of sentences and a list of words for further pre-processing.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>f=open('chatbot.txt','r',errors = 'ignore')</span><span>raw=f.read()</span><span>raw=raw.lower()# converts to lowercase</span><span>nltk.download('punkt') # first-time use only<br/>nltk.download('wordnet') # first-time use only</span><span>sent_tokens = nltk.sent_tokenize(raw)# converts to list of sentences <br/>word_tokens = nltk.word_tokenize(raw)# converts to list of words<br/></span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Let see an example of the sent_tokens and the word_tokens</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span><strong>sent_tokens[:2]</strong><br/>['a chatbot (also known as a talkbot, chatterbot, bot, im bot, interactive agent, or artificial conversational entity) is a computer program or an artificial intelligence which conducts a conversation via auditory or textual methods.',<br/> 'such programs are often designed to convincingly simulate how a human would behave as a conversational partner, thereby passing the turing test.']</span><span><strong>word_tokens[:2]</strong><br/>['a', 'chatbot', '(', 'also', 'known']</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Pre-processing the raw text</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We shall now define a function called LemTokens which will take as input the tokens and return normalized tokens.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>lemmer = nltk.stem.WordNetLemmatizer()<br/>#<em>WordNet is a semantically-oriented dictionary of English included in NLTK.</em></span><span>def LemTokens(tokens):<br/>    return [lemmer.lemmatize(token) for token in tokens]<br/>remove_punct_dict = dict((ord(punct), None) for punct in string.punctuation)<br/>def LemNormalize(text):<br/>    return LemTokens(nltk.word_tokenize(text.lower().translate(remove_punct_dict)))</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Keyword matching</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Next, we shall define a function for a greeting by the bot, i.e., if a user‚Äôs input is a greeting, the bot shall return a greeting response.ELIZA uses a simple keyword matching for greetings. We will utilize the same concept here.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>GREETING_INPUTS = ("hello", "hi", "greetings", "sup", "what's up","hey",)</span><span>GREETING_RESPONSES = ["hi", "hey", "*nods*", "hi there", "hello", "I am glad! You are talking to me"]</span><span>def greeting(sentence):<br/> <br/>    for word in sentence.split():<br/>        if word.lower() in GREETING_INPUTS:<br/>            return random.choice(GREETING_RESPONSES)</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Generating Response</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">To generate a response from our bot for input questions, the concept of document similarity will be used. So we begin by importing the necessary modules.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">From the scikit learn library, import the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" target="_self">TFidf vectorizer</a> to convert a collection of raw documents to a matrix of TF-IDF features.</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>from sklearn.feature_extraction.text import TfidfVectorizer</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><ul><li class="ff3" style="font-size:22px;">Also, import<a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html" target="_self"> cosine similarity</a> module from scikit learn library</li></ul></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>from sklearn.metrics.pairwise import cosine_similarity</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;"><em>This will be used to find the similarity between words entered by the user and the words in the corpus. </em>This is the simplest possible implementation of a chatbot.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">We define a function<strong> response</strong> that searches the user‚Äôs utterance for one or more general keywords and returns one of several possible responses. If it doesn‚Äôt find the input matching any of the keywords, it returns a response:‚Äù I am sorry! I don‚Äôt understand you.‚Äù</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>def response(user_response):<br/>    robo_response=''<br/>    sent_tokens.append(user_response)</span><span>    TfidfVec = TfidfVectorizer(tokenizer=LemNormalize, stop_words='english')<br/>    tfidf = TfidfVec.fit_transform(sent_tokens)<br/>    vals = cosine_similarity(tfidf[-1], tfidf)<br/>    idx=vals.argsort()[0][-2]<br/>    flat = vals.flatten()<br/>    flat.sort()<br/>    req_tfidf = flat[-2]</span><span>    if(req_tfidf==0):<br/>        robo_response=robo_response+"I am sorry! I don't understand you"<br/>        return robo_response<br/>    else:<br/>        robo_response = robo_response+sent_tokens[idx]<br/>        return robo_response</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Finally, we will feed the lines that we want our bot to say while starting and ending a conversation, depending upon the user‚Äôs input.</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="iframe"><pre><span>flag=True<br/>print("ROBO: My name is Robo. I will answer your queries about Chatbots. If you want to exit, type Bye!")</span><span>while(flag==True):<br/>    user_response = input()<br/>    user_response=user_response.lower()<br/>    if(user_response!='bye'):<br/>        if(user_response=='thanks' or user_response=='thank you' ):<br/>            flag=False<br/>            print("ROBO: You are welcome..")<br/>        else:<br/>            if(greeting(user_response)!=None):<br/>                print("ROBO: "+greeting(user_response))<br/>            else:<br/>                print("ROBO: ",end="")<br/>                print(response(user_response))<br/>                sent_tokens.remove(user_response)<br/>    else:<br/>        flag=False<br/>        print("ROBO: Bye! take care..")</span></pre></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">So that‚Äôs pretty much it. We have coded our first chatbot in NLTK. Now, let us see how it interacts with humans:</p></div></div></div></section><section data-bs-version="5.1" class="image3 cid-tt612oXwA9" id="image3-5" style="padding-top:0px; padding-bottom:0px; background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-9">
                <div class="image-wrapper"><div class="image_style" style="width:96%;"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*pPcVfZ7i-gLMabUol3zezA.gif 640w, https://miro.medium.com/v2/resize:fit:720/1*pPcVfZ7i-gLMabUol3zezA.gif 720w, https://miro.medium.com/v2/resize:fit:750/1*pPcVfZ7i-gLMabUol3zezA.gif 750w, https://miro.medium.com/v2/resize:fit:786/1*pPcVfZ7i-gLMabUol3zezA.gif 786w, https://miro.medium.com/v2/resize:fit:828/1*pPcVfZ7i-gLMabUol3zezA.gif 828w, https://miro.medium.com/v2/resize:fit:1100/1*pPcVfZ7i-gLMabUol3zezA.gif 1100w, https://miro.medium.com/v2/resize:fit:1400/1*pPcVfZ7i-gLMabUol3zezA.gif 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*pPcVfZ7i-gLMabUol3zezA.gif 640w, https://miro.medium.com/v2/resize:fit:720/1*pPcVfZ7i-gLMabUol3zezA.gif 720w, https://miro.medium.com/v2/resize:fit:750/1*pPcVfZ7i-gLMabUol3zezA.gif 750w, https://miro.medium.com/v2/resize:fit:786/1*pPcVfZ7i-gLMabUol3zezA.gif 786w, https://miro.medium.com/v2/resize:fit:828/1*pPcVfZ7i-gLMabUol3zezA.gif 828w, https://miro.medium.com/v2/resize:fit:1100/1*pPcVfZ7i-gLMabUol3zezA.gif 1100w, https://miro.medium.com/v2/resize:fit:1400/1*pPcVfZ7i-gLMabUol3zezA.gif 1400w"/><img alt="" loading="lazy" role="presentation" src="https://miro.medium.com/max/700/1*pPcVfZ7i-gLMabUol3zezA.gif"></picture></div><br></div></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">This wasn‚Äôt too bad. Even though the chatbot couldn‚Äôt give a satisfactory answer for some questions, it fared pretty well on others.</p></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><h4 class="mbr-section-subtitle mbr-fonts-style mb-4 display-7">Conclusion</h4></div></div></div></section><section data-bs-version="5.1" class="content5 cid-tt5UseJ9wk" id="content5-4" style="padding-top:0px; padding-bottom:0px;background-color: rgb(255, 255, 255);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-9"><p class="ff3" style="font-size:22px;">Though it is a very simple bot with hardly any cognitive skills, it's a good way to get into NLP and know about chatbots. However, ‚ÄòROBO‚Äô responds to user input. It won‚Äôt fool your friends, and for a production system, you‚Äôll want to consider one of the existing bot platforms or frameworks, but this example should help you think through the design and challenge of creating a chatbot. Internet is flooded with resources, and after reading this article, I am sure you will want to create a chatbot of your own. So happy tinkering!!</p></div></div></div></section><?php include_once 'Elemental/footer.php'; ?>